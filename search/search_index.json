{"config":{"lang":["en"],"separator":"[\\s\\u200b\\-_,:!=\\[\\]()\"`/]+|\\.(?!\\d)|&[lg]t;|(?!\\b)(?=[A-Z][a-z])","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Getting Started","text":""},{"location":"#getting-started","title":"Getting Started","text":"<p>Wodore Backend is the backend implementation of wodo.re.</p>"},{"location":"#production","title":"Production","text":"<ul> <li>Django with django ninja for the API and unfold admin</li> <li>PostgreSQL with PostGIS for the database</li> <li>Imagor for image serving and processing</li> <li>Zitadel for authentication and user management (optional)</li> </ul>"},{"location":"#dev-tools","title":"Dev Tools","text":"<ul> <li>uv for package management</li> <li>infisical for secrets management (optional)</li> </ul>"},{"location":"#development","title":"Development","text":""},{"location":"#initial-setup","title":"Initial Setup","text":"<p>Check Prerequisites for required tools.</p> <p>When first cloning the repository:</p> <pre><code># Install Python packages and set up virtualenv\nmake init\n# or\nuv sync\nuv run invoke install\n# afterwards activate the virtual environment\nsource .venv/bin/activate\n</code></pre>"},{"location":"#setup","title":"Setup","text":"<p>Activate the virtual environment and install packages:</p> <pre><code>source .venv/bin/activate\n\n# With infisical (recommended) -&gt; see Secrets section\n(.venv) inv install --infisical\n\n# Without infisical\n(.venv) inv install\n\n# View available commands\n(.venv) inv help\n\n# Apply changes\nsource deactivate; source .venv/bin/activate\n</code></pre> <p>NOTE: The install command creates <code>.volumes/pgdata/</code> for PostgreSQL data and <code>media/imagor_data/</code> for image processing.</p>"},{"location":"#secrets","title":"Secrets","text":"<p>Secrets are managed with infisical. Install the CLI tool following the installation guide and initialize it:</p> <pre><code>infisical login\ninfisical init\n</code></pre> <p>Set up secrets using infisical (recommended):</p> <pre><code>(.venv) inv install --infisical\nsource .venv/bin/activate\n(.venv) app &lt;cmd&gt; # uses infisical\n</code></pre> <p>Or use local env files:</p> <pre><code># Export secrets to config/.env (update when secrets change)\ninfisical export --env dev --path /backend &gt;&gt; config/.env\nln -s config/.env .env\n</code></pre> <p>Or set up manually:</p> <pre><code># Create and edit env files manually\ncp config/.env.template config/.env\nln -s config/.env .env\n# edit .env\n</code></pre> <p>TIP: Add <code>-i/--infisical</code> to <code>inv</code> commands (e.g., <code>run</code>, <code>docker-compose</code>) to use infisical directly.</p>"},{"location":"#start-database-and-image-service","title":"Start Database and Image Service","text":"<p>Start PostgreSQL and Imagor services after each system restart:</p> <pre><code># With infisical (recommended)\n(.venv) inv docker-compose -c \"up -d\" -i\n\n# Without infisical (requires .env file)\n(.venv) inv docker-compose -c \"up -d\"\n</code></pre> <p>NOTE: PostgreSQL data is stored in <code>.volumes/pgdata/</code> (development only). To reset the database:</p> <pre><code>rm -rf .volumes/pgdata/*  # Be careful!\n(.venv) inv docker-compose -c \"up -d\"\n</code></pre>"},{"location":"#required-postgresql-extensions","title":"Required PostgreSQL Extensions","text":"<p>The application requires the following PostgreSQL extensions for full functionality:</p> <ul> <li><code>postgis</code> - Geographic objects and spatial queries (already included in PostGIS image)</li> <li><code>pg_trgm</code> - Trigram similarity for fuzzy search and typo tolerance</li> <li><code>unaccent</code> - Accent-insensitive text search (optional but recommended)</li> </ul> <p>These extensions are installed automatically via Django migrations when you run <code>app migrate</code>. If you need to install them manually (e.g., on a production database):</p> <pre><code># Development (Docker)\ndocker compose exec db psql -U wodore -d wodore -c \"CREATE EXTENSION IF NOT EXISTS pg_trgm;\"\ndocker compose exec db psql -U wodore -d wodore -c \"CREATE EXTENSION IF NOT EXISTS unaccent;\"\n\n# Production/Kubernetes\nkubectl exec wd-backend-postgres-1 -- psql -U postgres -d wodore -c \"CREATE EXTENSION IF NOT EXISTS pg_trgm;\"\nkubectl exec wd-backend-postgres-1 -- psql -U postgres -d wodore -c \"CREATE EXTENSION IF NOT EXISTS unaccent;\"\n\n# Or via any PostgreSQL client\npsql -U wodore -d wodore -c \"CREATE EXTENSION IF NOT EXISTS pg_trgm;\"\npsql -U wodore -d wodore -c \"CREATE EXTENSION IF NOT EXISTS unaccent;\"\n</code></pre> <p>Note: Most managed PostgreSQL services (AWS RDS, Google Cloud SQL, Azure Database) allow these extensions without superuser privileges. If you encounter permission errors, contact your database administrator.</p>"},{"location":"#start-application","title":"Start Application","text":"<p>Start the application using the app alias (recommended):</p> <pre><code>(.venv) app migrate\n(.venv) app run -p 8000 # -i # with infisical\n</code></pre> <p>Or use invoke with infisical:</p> <pre><code>(.venv) app migrate -i\n(.venv) app run -p 8000 -i\n(.venv) # or written out\n(.venv) inv app.app -i --cmd \"migrate\"\n(.venv) inv app.app -i --cmd \"runserver\"\n</code></pre> <p>Or use local env files (requires <code>.env</code> and <code>config/.env</code>):</p> <pre><code>(.venv) inv app.app --cmd \"migrate\"\n(.venv) inv app.app --cmd \"runserver\"\n</code></pre> <p>NOTE: The <code>app</code> command expands to if infisical is used:</p> <pre><code>infisical run --env=dev --path /backend --silent --log-level warn -- app &lt;command&gt;\n</code></pre>"},{"location":"#load-data","title":"Load Data","text":"<p>Copy hut information from sources, this saves huts information from different sources (e.g. refuges.info, wikidata, open stree map) into the local database</p> <pre><code># Add all available sources\n(.venv) app hut_sources --add --orgs all\n\n# Add specific source (e.g. refuges)\n(.venv) app hut_sources --add --orgs refuges\n</code></pre> <p>Add huts from the previously added sources. If a hut has multiple sources they are combined as good as possible.</p> <pre><code># Add huts from sources (combines data if multiple sources)\n(.venv) app huts --add-all\n</code></pre>"},{"location":"#helpful-commands","title":"Helpful Commands","text":"<p>Common database commands:</p> <pre><code># Apply migrations\n(.venv) app migrate\n\n# Load initial data\n(.venv) app loaddata --app huts organizations\n\n# Squash migrations\n(.venv) app squashmigrations huts 0006 --squashed-name init\n</code></pre> <p>Watch and compile Tailwind CSS:</p> <pre><code>npx tailwindcss -i styles.css -o server/apps/manager/static/css/styles.css --minify --watch\n</code></pre>"},{"location":"#package-updates","title":"Package Updates","text":"<p>Update all packages:</p> <pre><code>(.venv) inv update # OR\n(.venv) inv update --no-private # do not update private packages (this removes the private packages)\n\n# Update hut-service (private package only)\n(.venv) inv update -p hut-services-private\n(.venv) # uv sync --upgrade-package hut-services-private --extra private\n(.venv) # uv lock\n</code></pre>"},{"location":"#changes","title":"Changes","text":"<p>After changes the version in <code>pyproject.toml</code> needs to be updated and the <code>wodore-backend</code> package updated and the docker image published:</p> <pre><code>(.venv) vim pyproject.toml\n(.venv) inv update -p wodore-backend\n(.venv) # uv sync --upgrade-package wodore-backend --extra private\n(.venv) inv docker.build --push # --version-tag\n</code></pre>"},{"location":"#release","title":"Release","text":"<p>For a release run <code>inv release</code>. Merge this change into the <code>main</code> branch, the github action will create a tag and a release.</p>"},{"location":"#docker-production-build","title":"Docker Production Build","text":"<p>Set required environment variables (or add it to the <code>.env</code> file):</p> <pre><code>READ_GITHUB_USER=&lt;username&gt;\nREAD_GITHUB_TOKEN=&lt;token&gt;  # Must have read access\n</code></pre> <p>(run <code>infisical export --env dev --path /keys/wodore-backend</code> to export the secrets)</p> <p>Build and run Docker images (default is alpine image):</p> <pre><code># Build main image\n(.venv) inv docker.build [--distro alpine|ubuntu] [-p/--push] [-v/--version-tag]\n\n# Create slim version (optional)\n(.venv) inv docker.slim [--distro alpine|ubuntu]\n\n# Run the container\n(.venv) inv docker.run [--distro alpine|ubuntu] [--slim]\n\n# Publish the container (use -v to include version tags as well, otherwise only 'edge' is pushed)\n(.venv) inv docker.publish [--distro alpine|ubuntu] [--slim] [-v/--version-tag]\n</code></pre> <p>NOTE: These commands are deprecated:</p> <pre><code># Export secrets (will be removed)\ninfisical export --env dev --path /backend &gt;&gt; config/.env\n\n# Build staging (use --env=prod for production)\ninfisical run --env=dev --path /backend -- \\\n  docker compose -f docker-compose.yml \\\n  -f docker/docker-compose.stage.yml build web\n</code></pre>"},{"location":"#prerequisites","title":"Prerequisites","text":"<p>Required development tools:</p> <ul> <li><code>python3.12</code> (see <code>pyproject.toml</code>)</li> <li><code>postgresql13</code></li> <li><code>docker</code> with <code>docker compose</code></li> <li><code>infisical</code> (installation guide) (optional)</li> <li><code>uv</code> (installation guide)</li> <li><code>node</code> and <code>npm</code> for Tailwind CSS</li> <li><code>make</code> (optional)</li> </ul>"},{"location":"#todos","title":"TODOs","text":"<p>See TODOS.md for future improvements and refactoring ideas.</p>"},{"location":"TODOS/","title":"Future Improvements &amp; TODOs","text":"<p>This document tracks potential improvements, refactoring ideas, and technical debt that should be addressed in future iterations.</p>"},{"location":"TODOS/#project-wide-improvements","title":"Project-Wide Improvements","text":""},{"location":"TODOS/#1-terminology-refactoring-openclosed-standardreduced","title":"1. Terminology Refactoring: \"Open/Closed\" \u2192 \"Standard/Reduced\"","text":"<p>Priority: Medium Effort: High (Major project-wide refactoring)</p> <p>Current state: The system uses \"open/closed\" terminology throughout the project: - Hut model: <code>hut_type_open</code> / <code>hut_type_closed</code>, <code>capacity_open</code> / <code>capacity_closed</code> - Availability app: All logic and queries reference open/closed states - Booking logic: External service integration uses open/closed concepts - External packages: <code>hut-services</code> and potentially <code>hut-services-private</code> may need updates</p> <p>Problem: The terms \"open\" and \"closed\" are misleading because: - A hut in \"closed\" state isn't necessarily closed - it may be unattended or in winter mode - The states represent operational modes, not whether the hut is accessible - Real-world example: A hut can be unattended in summer and fully closed in winter - Confusing for API consumers and frontend developers</p> <p>Proposed refactoring: Rename to \"standard/reduced\" terminology: - <code>hut_type_standard</code> / <code>hut_type_reduced</code> - <code>capacity_standard</code> / <code>capacity_reduced</code></p> <p>Benefits: - More accurate - Reflects that these are different operational modes with different capacities - Flexible - Works for any dual-state scenario (attended/unattended, summer/winter, full/partial) - Clear - \"Standard\" implies normal operation, \"reduced\" implies limited capacity/services - Better API - More intuitive for API consumers</p> <p>Impact: This is a major refactoring that would affect:</p> <p>Backend (wodore-backend): - Database schema (model fields, migrations) - Hut model in <code>server/apps/huts/models/_hut.py</code> - Availability service in <code>server/apps/availability/services.py</code> - Booking API endpoints in <code>server/apps/huts/api/_booking.py</code> - Admin interfaces for Huts and Availability - Django Ninja API schemas - External integrations reading these fields</p> <p>External packages: - <code>hut-services</code> - May need schema updates if it exposes these concepts - <code>hut-services-private</code> - Likely needs updates for consistency</p> <p>Frontend/API consumers: - Any existing API clients will need updates - Consider API versioning or backward compatibility layer</p> <p>Alternative terminology considered: - <code>normal/reduced</code> - <code>full/limited</code> - <code>primary/secondary</code> - <code>peak/off_peak</code></p> <p>Implementation steps: 1. Phase 1: External packages (if needed)    - Review <code>hut-services</code> and <code>hut-services-private</code> for references    - Update schemas and enums if necessary    - Publish new package versions</p> <ol> <li>Phase 2: Database migration</li> <li>Create Django migration to rename fields in Hut model</li> <li>Create migration for any foreign key references</li> <li> <p>Test migration on staging database</p> </li> <li> <p>Phase 3: Backend code</p> </li> <li>Update all model references in <code>server/apps/huts/models/_hut.py</code></li> <li>Update <code>server/apps/availability/services.py</code> logic and comments</li> <li>Update <code>server/apps/huts/api/_booking.py</code> API endpoints</li> <li>Update booking schemas in <code>server/apps/huts/schemas_booking/</code></li> <li>Update admin interfaces</li> <li> <p>Search codebase for any remaining \"open\"/\"closed\" references</p> </li> <li> <p>Phase 4: API compatibility</p> </li> <li>Decide on API versioning strategy</li> <li>Add backward compatibility if needed</li> <li> <p>Update API documentation</p> </li> <li> <p>Phase 5: Testing &amp; Documentation</p> </li> <li>Update all documentation (README, CLAUDE.md, etc.)</li> <li>Update tests</li> <li>Deploy to staging and verify</li> </ol> <p>Risks: - Breaking changes for existing API consumers - Complex migration if data is referenced externally - Potential downtime during migration</p>"},{"location":"TODOS/#availability-app","title":"Availability App","text":""},{"location":"TODOS/#2-generator-based-external-fetching","title":"2. Generator-based External Fetching","text":"<p>Priority: Low Effort: Medium</p> <p>Current limitation: All huts are fetched and returned as a complete list before processing begins. For very large batches, this can cause memory issues and delays the start of database updates.</p> <p>Proposed improvement: Refactor <code>hut-services-private</code> to use a generator pattern:</p> <pre><code># Future: Generator yields results as they're fetched\nfor hut_result in service.get_bookings_generator(\n    hut_slugs=slugs,\n    request_interval=0.1\n):\n    # Process and store each hut immediately\n    process_hut_bookings(hut_result)\n    progress_callback()\n</code></pre> <p>Benefits: - Streaming processing - Start storing data while still fetching remaining huts - Lower memory usage - Don't hold all results in memory at once - Better progress granularity - Progress updates happen as each hut is fetched - Request interval stays in external service - Rate limiting remains where it belongs</p> <p>Implementation notes: - Modify <code>hut-services-private</code> to yield <code>HutBookingsSchema</code> objects one at a time - Rate limiting (<code>request_interval</code>) stays in the external service between yields - Progress callback gets called after each yield in the availability service - Maintains clean separation of concerns (external fetching vs. database storage)</p>"},{"location":"TODOS/#3-other-availability-enhancements","title":"3. Other Availability Enhancements","text":"<p>Priority: Low Effort: Varies</p> <ul> <li>Add API endpoints (Django Ninja) for querying availability</li> <li>Add trend analysis endpoints</li> <li>Implement async task queue (Celery) for large batch updates</li> <li>Add parallel service calls when multiple external services are available</li> <li>Add data retention policies for old history entries</li> </ul>"},{"location":"TODOS/#general-todos","title":"General TODOs","text":"<p>Add other project-wide improvements here as they are identified</p>"},{"location":"api/","title":"API Documentation","text":"<p>Interactive API docs: hub.wodore.com/v1/docs</p>"},{"location":"api/#wodore-api-100","title":"Wodore API 1.0.0","text":""},{"location":"api/#hut","title":"hut","text":""},{"location":"api/#get-v1hutsbookings","title":"GET /v1/huts/bookings","text":"<p>Get hut bookings (deprecated)</p> Description <p>DEPRECATED: Use <code>/huts/availability.geojson</code> instead. This endpoint will be removed in a future version.</p> <p>Input parameters</p> Parameter In Type Default Nullable Description <code>date</code> query None now No Date to start with bookings (yyyy-mm-dd, 'now' or 'weekend'). <code>days</code> query integer 1 No Show bookings for this many days. <code>lang</code> query string de No Select language code: de, en, fr, it. <code>request_interval</code> query None No Time in seconds to wait between requests to the booking service for each hut. If not set uses recommanded default value. <code>slugs</code> query None No Comma separated list with slugs to use, per default all. <p> Response 200 OK </p> application/json <p><pre><code>[\n    {\n        \"slug\": \"string\",\n        \"hut_id\": 0,\n        \"source_id\": \"string\",\n        \"source\": \"string\",\n        \"days\": 0,\n        \"link\": \"string\",\n        \"start_date\": \"2022-04-13\",\n        \"bookings\": [\n            {\n                \"link\": \"string\",\n                \"date\": \"2022-04-13\",\n                \"reservation_status\": \"unknown\",\n                \"free\": 0,\n                \"total\": 0,\n                \"occupancy_percent\": 10.12,\n                \"occupancy_steps\": 0,\n                \"occupancy_status\": \"unknown\",\n                \"hut_type\": \"string\"\n            }\n        ],\n        \"location\": {\n            \"lat\": 10.12,\n            \"lon\": 10.12\n        }\n    }\n]\n</code></pre> \u26a0\ufe0f This example has been generated automatically from the schema and it is not accurate. Refer to the schema for more information.</p> Schema of the response body <pre><code>{\n    \"items\": {\n        \"$ref\": \"#/components/schemas/HutBookingsSchema\"\n    },\n    \"title\": \"Response\",\n    \"type\": \"array\"\n}\n</code></pre>"},{"location":"api/#get-v1hutsbookingsgeojson","title":"GET /v1/huts/bookings.geojson","text":"<p>Get hut bookings as GeoJSON (deprecated)</p> Description <p>DEPRECATED: Use <code>/huts/availability.geojson</code> instead. This endpoint will be removed in a future version.</p> <p>Input parameters</p> Parameter In Type Default Nullable Description <code>date</code> query None now No Date to start with bookings (yyyy-mm-dd, 'now' or 'weekend'). <code>days</code> query integer 1 No Show bookings for this many days. <code>lang</code> query string de No Select language code: de, en, fr, it. <code>request_interval</code> query None No Time in seconds to wait between requests to the booking service for each hut. If not set uses recommanded default value. <code>slugs</code> query None No Comma separated list with slugs to use, per default all. <p> Response 200 OK </p> application/json <p><pre><code>{\n    \"bbox\": null,\n    \"type\": \"string\",\n    \"features\": [\n        {\n            \"bbox\": null,\n            \"type\": \"string\",\n            \"geometry\": null,\n            \"properties\": null,\n            \"id\": null\n        }\n    ]\n}\n</code></pre> \u26a0\ufe0f This example has been generated automatically from the schema and it is not accurate. Refer to the schema for more information.</p> Schema of the response body <pre><code>{\n    \"properties\": {\n        \"bbox\": {\n            \"anyOf\": [\n                {\n                    \"maxItems\": 4,\n                    \"minItems\": 4,\n                    \"prefixItems\": [\n                        {\n                            \"type\": \"number\"\n                        },\n                        {\n                            \"type\": \"number\"\n                        },\n                        {\n                            \"type\": \"number\"\n                        },\n                        {\n                            \"type\": \"number\"\n                        }\n                    ],\n                    \"type\": \"array\"\n                },\n                {\n                    \"maxItems\": 6,\n                    \"minItems\": 6,\n                    \"prefixItems\": [\n                        {\n                            \"type\": \"number\"\n                        },\n                        {\n                            \"type\": \"number\"\n                        },\n                        {\n                            \"type\": \"number\"\n                        },\n                        {\n                            \"type\": \"number\"\n                        },\n                        {\n                            \"type\": \"number\"\n                        },\n                        {\n                            \"type\": \"number\"\n                        }\n                    ],\n                    \"type\": \"array\"\n                },\n                {\n                    \"type\": \"null\"\n                }\n            ],\n            \"title\": \"Bbox\"\n        },\n        \"type\": {\n            \"const\": \"FeatureCollection\",\n            \"title\": \"Type\",\n            \"type\": \"string\"\n        },\n        \"features\": {\n            \"items\": {\n                \"$ref\": \"#/components/schemas/Feature_Point_HutBookingsProps_\"\n            },\n            \"title\": \"Features\",\n            \"type\": \"array\"\n        }\n    },\n    \"required\": [\n        \"type\",\n        \"features\"\n    ],\n    \"title\": \"HutBookingsFeatureCollection\",\n    \"type\": \"object\"\n}\n</code></pre>"},{"location":"api/#get-v1hutstypeslist","title":"GET /v1/huts/types/list","text":"<p>Get Hut Types</p> <p>Input parameters</p> Parameter In Type Default Nullable Description <code>exclude</code> query None No Comma separated list with field names, if set it uses all fields except the excluded ones. <code>include</code> query None No Comma separated list with field names, use `__all__` in order to include every field. <code>lang</code> query string de No Select language code: de, en, fr, it. <p> Response 200 OK </p> application/json <p><pre><code>[\n    {\n        \"slug\": \"string\",\n        \"name\": \"string\",\n        \"description\": \"string\",\n        \"symbol\": null,\n        \"level\": null,\n        \"symbol_simple\": null,\n        \"icon\": null\n    }\n]\n</code></pre> \u26a0\ufe0f This example has been generated automatically from the schema and it is not accurate. Refer to the schema for more information.</p> Schema of the response body <pre><code>{\n    \"items\": {\n        \"$ref\": \"#/components/schemas/HutTypeDetailSchema\"\n    },\n    \"title\": \"Response\",\n    \"type\": \"array\"\n}\n</code></pre>"},{"location":"api/#get-v1hutstypesrecords","title":"GET /v1/huts/types/records","text":"<p>Get Hut Type Records</p> <p>Input parameters</p> Parameter In Type Default Nullable Description <code>exclude</code> query None No Comma separated list with field names, if set it uses all fields except the excluded ones. <code>include</code> query None No Comma separated list with field names, use `__all__` in order to include every field. <code>lang</code> query string de No Select language code: de, en, fr, it. <p> Response 200 OK </p> application/json Schema of the response body <pre><code>{\n    \"additionalProperties\": {\n        \"$ref\": \"#/components/schemas/HutTypeDetailSchema\"\n    },\n    \"title\": \"Response\",\n    \"type\": \"object\"\n}\n</code></pre>"},{"location":"api/#get-v1hutsavailabilitydategeojson","title":"GET /v1/huts/availability/{date}.geojson","text":"<p>Get Hut Availability Geojson</p> Description <p>Get availability data as GeoJSON FeatureCollection for map visualization.</p> <p>Input parameters</p> Parameter In Type Default Nullable Description <code>date</code> path string No Start date. Accepts ISO dates (2026-01-15, 26-01-15), European format (15.01.2026), or keywords: 'now', 'today', 'weekend'. <code>days</code> query integer 1 No Number of days to fetch from start date. <code>lang</code> query string de No Select language code: de, en, fr, it. <code>limit</code> query None No Maximum number of huts to return. If not set, returns all matching huts. <code>offset</code> query integer 0 No Pagination offset for results. <code>slugs</code> query None No Comma-separated list of hut slugs to filter (e.g., 'aarbiwak,almageller'). If not set, returns all huts. <p> Response 200 OK </p> application/json <p><pre><code>{\n    \"bbox\": null,\n    \"type\": \"string\",\n    \"features\": [\n        {\n            \"bbox\": null,\n            \"type\": \"string\",\n            \"geometry\": null,\n            \"properties\": null,\n            \"id\": null\n        }\n    ]\n}\n</code></pre> \u26a0\ufe0f This example has been generated automatically from the schema and it is not accurate. Refer to the schema for more information.</p> Schema of the response body <pre><code>{\n    \"description\": \"GeoJSON FeatureCollection of hut availability data.\",\n    \"properties\": {\n        \"bbox\": {\n            \"anyOf\": [\n                {\n                    \"maxItems\": 4,\n                    \"minItems\": 4,\n                    \"prefixItems\": [\n                        {\n                            \"type\": \"number\"\n                        },\n                        {\n                            \"type\": \"number\"\n                        },\n                        {\n                            \"type\": \"number\"\n                        },\n                        {\n                            \"type\": \"number\"\n                        }\n                    ],\n                    \"type\": \"array\"\n                },\n                {\n                    \"maxItems\": 6,\n                    \"minItems\": 6,\n                    \"prefixItems\": [\n                        {\n                            \"type\": \"number\"\n                        },\n                        {\n                            \"type\": \"number\"\n                        },\n                        {\n                            \"type\": \"number\"\n                        },\n                        {\n                            \"type\": \"number\"\n                        },\n                        {\n                            \"type\": \"number\"\n                        },\n                        {\n                            \"type\": \"number\"\n                        }\n                    ],\n                    \"type\": \"array\"\n                },\n                {\n                    \"type\": \"null\"\n                }\n            ],\n            \"title\": \"Bbox\"\n        },\n        \"type\": {\n            \"const\": \"FeatureCollection\",\n            \"title\": \"Type\",\n            \"type\": \"string\"\n        },\n        \"features\": {\n            \"items\": {\n                \"$ref\": \"#/components/schemas/Feature_Point_HutAvailabilityPropertiesSchema_\"\n            },\n            \"title\": \"Features\",\n            \"type\": \"array\"\n        }\n    },\n    \"required\": [\n        \"type\",\n        \"features\"\n    ],\n    \"title\": \"HutAvailabilityFeatureCollection\",\n    \"type\": \"object\"\n}\n</code></pre>"},{"location":"api/#get-v1hutsslugavailabilitydate","title":"GET /v1/huts/{slug}/availability/{date}","text":"<p>Get Hut Availability Current</p> Description <p>Get current availability data for a specific hut with detailed metadata and booking links.</p> <p>Input parameters</p> Parameter In Type Default Nullable Description <code>date</code> path string No Start date. Accepts ISO dates (2026-01-15, 26-01-15), European format (15.01.2026), or keywords: 'now', 'today', 'weekend'. <code>days</code> query integer 1 No Number of days to fetch from start date. <code>lang</code> query string de No Select language code: de, en, fr, it. <code>slug</code> path string No <p> Response 200 OK </p> application/json <p><pre><code>{\n    \"slug\": \"string\",\n    \"id\": 0,\n    \"source_id\": \"string\",\n    \"source_link\": \"string\",\n    \"source\": \"string\",\n    \"days\": 0,\n    \"start_date\": \"2022-04-13\",\n    \"data\": [\n        {\n            \"date\": \"2022-04-13\",\n            \"reservation_status\": \"unknown\",\n            \"free\": 0,\n            \"total\": 0,\n            \"occupancy_percent\": 10.12,\n            \"occupancy_steps\": 0,\n            \"occupancy_status\": \"unknown\",\n            \"hut_type\": \"string\",\n            \"link\": \"string\",\n            \"first_checked\": \"2022-04-13T15:42:05.901Z\",\n            \"last_checked\": \"2022-04-13T15:42:05.901Z\"\n        }\n    ]\n}\n</code></pre> \u26a0\ufe0f This example has been generated automatically from the schema and it is not accurate. Refer to the schema for more information.</p> Schema of the response body <pre><code>{\n    \"description\": \"Current availability data for a specific hut.\",\n    \"properties\": {\n        \"slug\": {\n            \"description\": \"Hut slug identifier\",\n            \"title\": \"Slug\",\n            \"type\": \"string\"\n        },\n        \"id\": {\n            \"description\": \"Hut database ID\",\n            \"title\": \"Id\",\n            \"type\": \"integer\"\n        },\n        \"source_id\": {\n            \"description\": \"External source organization's ID for this hut\",\n            \"title\": \"Source Id\",\n            \"type\": \"string\"\n        },\n        \"source_link\": {\n            \"description\": \"External source organization's link for this hut\",\n            \"title\": \"Source Link\",\n            \"type\": \"string\"\n        },\n        \"source\": {\n            \"description\": \"Source organization slug (e.g., 'hrs', 'sac')\",\n            \"title\": \"Source\",\n            \"type\": \"string\"\n        },\n        \"days\": {\n            \"description\": \"Number of days of availability data\",\n            \"minimum\": 1,\n            \"title\": \"Days\",\n            \"type\": \"integer\"\n        },\n        \"start_date\": {\n            \"description\": \"Start date of availability period\",\n            \"format\": \"date\",\n            \"title\": \"Start Date\",\n            \"type\": \"string\"\n        },\n        \"data\": {\n            \"description\": \"List of current availability data for each day\",\n            \"items\": {\n                \"$ref\": \"#/components/schemas/CurrentAvailabilityDaySchema\"\n            },\n            \"title\": \"Data\",\n            \"type\": \"array\"\n        }\n    },\n    \"required\": [\n        \"slug\",\n        \"id\",\n        \"source_id\",\n        \"source_link\",\n        \"source\",\n        \"days\",\n        \"start_date\",\n        \"data\"\n    ],\n    \"title\": \"CurrentAvailabilitySchema\",\n    \"type\": \"object\"\n}\n</code></pre>"},{"location":"api/#get-v1hutsslugavailabilitydatetrend","title":"GET /v1/huts/{slug}/availability/{date}/trend","text":"<p>Get Hut Availability Trend</p> Description <p>Get historical availability trend data showing how availability changed over time for a specific date.</p> <p>Input parameters</p> Parameter In Type Default Nullable Description <code>date</code> path string No Target date to analyze. Accepts ISO dates (2026-01-15, 26-01-15), European format (15.01.2026), or keywords: 'now', 'today', 'weekend'. <code>lang</code> query string de No Select language code: de, en, fr, it. <code>limit</code> query integer 7 No How many days back to show history from the target date. <code>slug</code> path string No <p> Response 200 OK </p> application/json <p><pre><code>{\n    \"slug\": \"string\",\n    \"id\": 0,\n    \"target_date\": \"2022-04-13\",\n    \"period_start\": \"2022-04-13\",\n    \"period_end\": \"2022-04-13\",\n    \"data\": [\n        {\n            \"date\": \"2022-04-13\",\n            \"free\": 0,\n            \"total\": 0,\n            \"occupancy_percent\": 10.12,\n            \"occupancy_status\": \"unknown\",\n            \"reservation_status\": \"unknown\",\n            \"hut_type\": \"string\",\n            \"first_checked\": \"2022-04-13T15:42:05.901Z\",\n            \"last_checked\": \"2022-04-13T15:42:05.901Z\"\n        }\n    ]\n}\n</code></pre> \u26a0\ufe0f This example has been generated automatically from the schema and it is not accurate. Refer to the schema for more information.</p> Schema of the response body <pre><code>{\n    \"description\": \"Historical availability trend data for a specific hut and date.\",\n    \"properties\": {\n        \"slug\": {\n            \"description\": \"Hut slug identifier\",\n            \"title\": \"Slug\",\n            \"type\": \"string\"\n        },\n        \"id\": {\n            \"description\": \"Hut database ID\",\n            \"title\": \"Id\",\n            \"type\": \"integer\"\n        },\n        \"target_date\": {\n            \"description\": \"The date for which trend data is shown\",\n            \"format\": \"date\",\n            \"title\": \"Target Date\",\n            \"type\": \"string\"\n        },\n        \"period_start\": {\n            \"description\": \"Start of the trend period (target_date - limit days)\",\n            \"format\": \"date\",\n            \"title\": \"Period Start\",\n            \"type\": \"string\"\n        },\n        \"period_end\": {\n            \"description\": \"End of the trend period (target_date)\",\n            \"format\": \"date\",\n            \"title\": \"Period End\",\n            \"type\": \"string\"\n        },\n        \"data\": {\n            \"description\": \"Historical availability changes, ordered by first_checked (newest first)\",\n            \"items\": {\n                \"$ref\": \"#/components/schemas/AvailabilityTrendDaySchema\"\n            },\n            \"title\": \"Data\",\n            \"type\": \"array\"\n        }\n    },\n    \"required\": [\n        \"slug\",\n        \"id\",\n        \"target_date\",\n        \"period_start\",\n        \"period_end\",\n        \"data\"\n    ],\n    \"title\": \"AvailabilityTrendSchema\",\n    \"type\": \"object\"\n}\n</code></pre>"},{"location":"api/#get-v1hutssearch","title":"GET /v1/huts/search","text":"<p>Search Huts</p> Description <p>Search for huts using fuzzy text search across all language fields.</p> <p>Input parameters</p> Parameter In Type Default Nullable Description <code>include_avatar</code> query boolean True No Include avatar/primary photo URL in results <code>include_hut_type</code> query None no No Include hut type information: 'no' excludes field, 'slug' returns type slugs only, 'all' returns full type details with icons <code>include_sources</code> query None no No Include data sources: 'no' excludes field, 'slug' returns source slugs only, 'all' returns full source details with logos <code>lang</code> query string de No Select language code: de, en, fr, it. <code>limit</code> query None 15 No Maximum number of results to return <code>offset</code> query integer 0 No Number of results to skip for pagination <code>q</code> query string No Search query string to match against hut names in all languages <code>threshold</code> query number 0.1 No Minimum similarity score (0.0-1.0). Lower values return more results but with lower relevance. Recommended: 0.1 for fuzzy matching, 0.3 for stricter matching. <p> Response 200 OK </p> application/json <p><pre><code>[\n    {\n        \"name\": \"string\",\n        \"slug\": \"string\",\n        \"hut_type\": null,\n        \"capacity\": {\n            \"open\": null,\n            \"closed\": null\n        },\n        \"location\": {\n            \"lat\": 10.12,\n            \"lon\": 10.12\n        },\n        \"elevation\": null,\n        \"avatar\": null,\n        \"score\": 10.12,\n        \"sources\": null\n    }\n]\n</code></pre> \u26a0\ufe0f This example has been generated automatically from the schema and it is not accurate. Refer to the schema for more information.</p> Schema of the response body <pre><code>{\n    \"items\": {\n        \"$ref\": \"#/components/schemas/HutSearchResultSchema\"\n    },\n    \"title\": \"Response\",\n    \"type\": \"array\"\n}\n</code></pre>"},{"location":"api/#get-v1hutshuts","title":"GET /v1/huts/huts","text":"<p>Get Huts</p> Description <p>Get a list with huts.</p> <p>Input parameters</p> Parameter In Type Default Nullable Description <code>has_availability</code> query None unset No <code>is_active</code> query None true No <code>is_modified</code> query None unset No <code>is_public</code> query None true No <code>lang</code> query string de No Select language code: de, en, fr, it. <code>limit</code> query None No <code>offset</code> query integer 0 No <p> Response 200 OK </p> application/json <p><pre><code>[\n    {\n        \"slug\": \"string\",\n        \"name\": null,\n        \"description\": null,\n        \"description_attribution\": \"string\",\n        \"owner\": null,\n        \"review_status\": null,\n        \"is_public\": null,\n        \"is_active\": null,\n        \"is_modified\": null,\n        \"type_open\": null,\n        \"type_closed\": null,\n        \"elevation\": null,\n        \"location\": null,\n        \"url\": null,\n        \"country\": null,\n        \"capacity_open\": null,\n        \"capacity_closed\": null,\n        \"sources\": null,\n        \"photos\": \"string\",\n        \"photos_attribution\": \"string\",\n        \"images\": null,\n        \"open_monthly\": null,\n        \"has_availability\": null,\n        \"availability_source\": null\n    }\n]\n</code></pre> \u26a0\ufe0f This example has been generated automatically from the schema and it is not accurate. Refer to the schema for more information.</p> Schema of the response body <pre><code>{\n    \"items\": {\n        \"$ref\": \"#/components/schemas/HutSchemaList\"\n    },\n    \"title\": \"Response\",\n    \"type\": \"array\"\n}\n</code></pre>"},{"location":"api/#get-v1hutshutsgeojson","title":"GET /v1/huts/huts.geojson","text":"<p>Get Huts Geojson</p> <p>Input parameters</p> Parameter In Type Default Nullable Description <code>embed_all</code> query boolean False No <code>embed_capacity</code> query boolean False No <code>embed_owner</code> query boolean False No <code>embed_sources</code> query boolean False No <code>embed_type</code> query boolean False No <code>flat</code> query boolean True No <code>has_availability</code> query None unset No <code>include_elevation</code> query boolean False No <code>include_has_availability</code> query boolean False No <code>include_name</code> query boolean False No <code>lang</code> query string de No Select language code: de, en, fr, it. <code>limit</code> query None No <code>offset</code> query integer 0 No <p> Response 200 OK </p> application/json <p><pre><code>{\n    \"bbox\": null,\n    \"type\": \"string\",\n    \"features\": [\n        {\n            \"bbox\": null,\n            \"type\": \"string\",\n            \"geometry\": null,\n            \"properties\": null,\n            \"id\": null\n        }\n    ]\n}\n</code></pre> \u26a0\ufe0f This example has been generated automatically from the schema and it is not accurate. Refer to the schema for more information.</p> Schema of the response body <pre><code>{\n    \"description\": \"FeatureCollection Model\",\n    \"properties\": {\n        \"bbox\": {\n            \"anyOf\": [\n                {\n                    \"maxItems\": 4,\n                    \"minItems\": 4,\n                    \"prefixItems\": [\n                        {\n                            \"type\": \"number\"\n                        },\n                        {\n                            \"type\": \"number\"\n                        },\n                        {\n                            \"type\": \"number\"\n                        },\n                        {\n                            \"type\": \"number\"\n                        }\n                    ],\n                    \"type\": \"array\"\n                },\n                {\n                    \"maxItems\": 6,\n                    \"minItems\": 6,\n                    \"prefixItems\": [\n                        {\n                            \"type\": \"number\"\n                        },\n                        {\n                            \"type\": \"number\"\n                        },\n                        {\n                            \"type\": \"number\"\n                        },\n                        {\n                            \"type\": \"number\"\n                        },\n                        {\n                            \"type\": \"number\"\n                        },\n                        {\n                            \"type\": \"number\"\n                        }\n                    ],\n                    \"type\": \"array\"\n                },\n                {\n                    \"type\": \"null\"\n                }\n            ],\n            \"title\": \"Bbox\"\n        },\n        \"type\": {\n            \"const\": \"FeatureCollection\",\n            \"title\": \"Type\",\n            \"type\": \"string\"\n        },\n        \"features\": {\n            \"items\": {\n                \"$ref\": \"#/components/schemas/Feature\"\n            },\n            \"title\": \"Features\",\n            \"type\": \"array\"\n        }\n    },\n    \"required\": [\n        \"type\",\n        \"features\"\n    ],\n    \"title\": \"FeatureCollection\",\n    \"type\": \"object\"\n}\n</code></pre>"},{"location":"api/#get-v1hutsslug","title":"GET /v1/huts/{slug}","text":"<p>Get Hut</p> Description <p>Get a hut by its slug.</p> <p>Input parameters</p> Parameter In Type Default Nullable Description <code>exclude</code> query None No Comma separated list with field names, if set it uses all fields except the excluded ones. <code>include</code> query None No Comma separated list with field names, use `__all__` in order to include every field. <code>lang</code> query string de No Select language code: de, en, fr, it. <code>slug</code> path string No <p> Response 200 OK </p> application/json <p><pre><code>{\n    \"slug\": \"string\",\n    \"name\": null,\n    \"description\": null,\n    \"description_attribution\": \"string\",\n    \"owner\": null,\n    \"review_status\": null,\n    \"is_public\": null,\n    \"is_active\": null,\n    \"is_modified\": null,\n    \"type_open\": null,\n    \"type_closed\": null,\n    \"elevation\": null,\n    \"location\": null,\n    \"url\": null,\n    \"country\": null,\n    \"capacity_open\": null,\n    \"capacity_closed\": null,\n    \"sources\": null,\n    \"photos\": \"string\",\n    \"photos_attribution\": \"string\",\n    \"images\": null,\n    \"open_monthly\": null,\n    \"has_availability\": null,\n    \"availability_source\": null,\n    \"edit_link\": null,\n    \"translations\": null,\n    \"created\": null,\n    \"modified\": null\n}\n</code></pre> \u26a0\ufe0f This example has been generated automatically from the schema and it is not accurate. Refer to the schema for more information.</p> Schema of the response body <pre><code>{\n    \"description\": \"Schema for single hut detail endpoint (with all details including timestamps).\",\n    \"properties\": {\n        \"slug\": {\n            \"title\": \"Slug\",\n            \"type\": \"string\"\n        },\n        \"name\": {\n            \"anyOf\": [\n                {\n                    \"type\": \"string\"\n                },\n                {\n                    \"type\": \"null\"\n                }\n            ],\n            \"title\": \"Name\"\n        },\n        \"description\": {\n            \"anyOf\": [\n                {\n                    \"type\": \"string\"\n                },\n                {\n                    \"type\": \"null\"\n                }\n            ],\n            \"title\": \"Description\"\n        },\n        \"description_attribution\": {\n            \"title\": \"Description Attribution\",\n            \"type\": \"string\"\n        },\n        \"owner\": {\n            \"anyOf\": [\n                {\n                    \"$ref\": \"#/components/schemas/OwnerSchema\"\n                },\n                {\n                    \"type\": \"null\"\n                }\n            ]\n        },\n        \"review_status\": {\n            \"anyOf\": [\n                {\n                    \"type\": \"string\"\n                },\n                {\n                    \"type\": \"null\"\n                }\n            ],\n            \"title\": \"Review Status\"\n        },\n        \"is_public\": {\n            \"anyOf\": [\n                {\n                    \"type\": \"boolean\"\n                },\n                {\n                    \"type\": \"null\"\n                }\n            ],\n            \"title\": \"Is Public\"\n        },\n        \"is_active\": {\n            \"anyOf\": [\n                {\n                    \"type\": \"boolean\"\n                },\n                {\n                    \"type\": \"null\"\n                }\n            ],\n            \"title\": \"Is Active\"\n        },\n        \"is_modified\": {\n            \"anyOf\": [\n                {\n                    \"type\": \"boolean\"\n                },\n                {\n                    \"type\": \"null\"\n                }\n            ],\n            \"title\": \"Is Modified\"\n        },\n        \"type_open\": {\n            \"anyOf\": [\n                {\n                    \"$ref\": \"#/components/schemas/HutTypeSchema\"\n                },\n                {\n                    \"type\": \"null\"\n                }\n            ]\n        },\n        \"type_closed\": {\n            \"anyOf\": [\n                {\n                    \"$ref\": \"#/components/schemas/HutTypeSchema\"\n                },\n                {\n                    \"type\": \"null\"\n                }\n            ]\n        },\n        \"elevation\": {\n            \"anyOf\": [\n                {\n                    \"type\": \"number\"\n                },\n                {\n                    \"type\": \"null\"\n                }\n            ],\n            \"title\": \"Elevation\"\n        },\n        \"location\": {\n            \"anyOf\": [\n                {\n                    \"$ref\": \"#/components/schemas/LocationSchema\"\n                },\n                {\n                    \"type\": \"null\"\n                }\n            ]\n        },\n        \"url\": {\n            \"anyOf\": [\n                {\n                    \"type\": \"string\"\n                },\n                {\n                    \"type\": \"null\"\n                }\n            ],\n            \"title\": \"Url\"\n        },\n        \"country\": {\n            \"anyOf\": [\n                {\n                    \"$ref\": \"#/components/schemas/CountryTuple\"\n                },\n                {\n                    \"type\": \"null\"\n                }\n            ]\n        },\n        \"capacity_open\": {\n            \"anyOf\": [\n                {\n                    \"type\": \"integer\"\n                },\n                {\n                    \"type\": \"null\"\n                }\n            ],\n            \"title\": \"Capacity Open\"\n        },\n        \"capacity_closed\": {\n            \"anyOf\": [\n                {\n                    \"type\": \"integer\"\n                },\n                {\n                    \"type\": \"null\"\n                }\n            ],\n            \"title\": \"Capacity Closed\"\n        },\n        \"sources\": {\n            \"anyOf\": [\n                {\n                    \"items\": {\n                        \"$ref\": \"#/components/schemas/OrganizationBaseSchema\"\n                    },\n                    \"type\": \"array\"\n                },\n                {\n                    \"type\": \"null\"\n                }\n            ],\n            \"title\": \"Sources\"\n        },\n        \"photos\": {\n            \"default\": \"\",\n            \"title\": \"Photos\",\n            \"type\": \"string\"\n        },\n        \"photos_attribution\": {\n            \"default\": \"\",\n            \"title\": \"Photos Attribution\",\n            \"type\": \"string\"\n        },\n        \"images\": {\n            \"anyOf\": [\n                {\n                    \"items\": {\n                        \"$ref\": \"#/components/schemas/ImageInfoSchema\"\n                    },\n                    \"type\": \"array\"\n                },\n                {\n                    \"type\": \"null\"\n                }\n            ],\n            \"title\": \"Images\"\n        },\n        \"open_monthly\": {\n            \"anyOf\": [\n                {\n                    \"$ref\": \"#/components/schemas/OpenMonthlySchema\"\n                },\n                {\n                    \"type\": \"null\"\n                }\n            ]\n        },\n        \"has_availability\": {\n            \"anyOf\": [\n                {\n                    \"type\": \"boolean\"\n                },\n                {\n                    \"type\": \"null\"\n                }\n            ],\n            \"title\": \"Has Availability\"\n        },\n        \"availability_source\": {\n            \"anyOf\": [\n                {\n                    \"type\": \"string\"\n                },\n                {\n                    \"type\": \"null\"\n                }\n            ],\n            \"title\": \"Availability Source\"\n        },\n        \"edit_link\": {\n            \"anyOf\": [\n                {\n                    \"type\": \"string\"\n                },\n                {\n                    \"type\": \"null\"\n                }\n            ],\n            \"title\": \"Edit Link\"\n        },\n        \"translations\": {\n            \"anyOf\": [\n                {},\n                {\n                    \"type\": \"null\"\n                }\n            ],\n            \"title\": \"Translations\"\n        },\n        \"created\": {\n            \"anyOf\": [\n                {\n                    \"format\": \"date-time\",\n                    \"type\": \"string\"\n                },\n                {\n                    \"type\": \"null\"\n                }\n            ],\n            \"title\": \"Created\"\n        },\n        \"modified\": {\n            \"anyOf\": [\n                {\n                    \"format\": \"date-time\",\n                    \"type\": \"string\"\n                },\n                {\n                    \"type\": \"null\"\n                }\n            ],\n            \"title\": \"Modified\"\n        }\n    },\n    \"required\": [\n        \"slug\",\n        \"name\",\n        \"description\",\n        \"description_attribution\",\n        \"owner\",\n        \"sources\",\n        \"images\"\n    ],\n    \"title\": \"HutSchemaDetails\",\n    \"type\": \"object\"\n}\n</code></pre>"},{"location":"api/#organization","title":"organization","text":""},{"location":"api/#get-v1organizations","title":"GET /v1/organizations/","text":"<p>Get Organizations</p> Description <p>Get a list of all organizations used for the huts.</p> <p>Input parameters</p> Parameter In Type Default Nullable Description <code>exclude</code> query None No Comma separated list with field names, if set it uses all fields except the excluded ones. <code>include</code> query None No Comma separated list with field names, use `__all__` in order to include every field. <code>is_public</code> query None No <code>lang</code> query string de No Select language code: de, en, fr, it. <p> Response 200 OK </p> application/json <p><pre><code>[\n    {\n        \"name\": null,\n        \"fullname\": null,\n        \"description\": null,\n        \"attribution\": null,\n        \"url\": null,\n        \"config\": null,\n        \"props_schema\": null,\n        \"order\": null,\n        \"slug\": null,\n        \"link_hut_pattern\": null,\n        \"logo\": null,\n        \"is_active\": null,\n        \"is_public\": null,\n        \"color_light\": null,\n        \"color_dark\": null\n    }\n]\n</code></pre> \u26a0\ufe0f This example has been generated automatically from the schema and it is not accurate. Refer to the schema for more information.</p> Schema of the response body <pre><code>{\n    \"items\": {\n        \"$ref\": \"#/components/schemas/OrganizationOptional\"\n    },\n    \"title\": \"Response\",\n    \"type\": \"array\"\n}\n</code></pre>"},{"location":"api/#get-v1organizationsslug","title":"GET /v1/organizations/{slug}","text":"<p>Get Organization</p> <p>Input parameters</p> Parameter In Type Default Nullable Description <code>exclude</code> query None No Comma separated list with field names, if set it uses all fields except the excluded ones. <code>include</code> query None No Comma separated list with field names, use `__all__` in order to include every field. <code>lang</code> query string de No Select language code: de, en, fr, it. <code>slug</code> path string No <p> Response 200 OK </p> application/json <p><pre><code>{\n    \"name\": null,\n    \"fullname\": null,\n    \"description\": null,\n    \"attribution\": null,\n    \"url\": null,\n    \"config\": null,\n    \"props_schema\": null,\n    \"order\": null,\n    \"slug\": null,\n    \"link_hut_pattern\": null,\n    \"logo\": null,\n    \"is_active\": null,\n    \"is_public\": null,\n    \"color_light\": null,\n    \"color_dark\": null\n}\n</code></pre> \u26a0\ufe0f This example has been generated automatically from the schema and it is not accurate. Refer to the schema for more information.</p> Schema of the response body <pre><code>{\n    \"properties\": {\n        \"name\": {\n            \"anyOf\": [\n                {\n                    \"type\": \"string\"\n                },\n                {\n                    \"type\": \"null\"\n                }\n            ],\n            \"title\": \"Name\"\n        },\n        \"fullname\": {\n            \"anyOf\": [\n                {\n                    \"type\": \"string\"\n                },\n                {\n                    \"type\": \"null\"\n                }\n            ],\n            \"title\": \"Fullname\"\n        },\n        \"description\": {\n            \"anyOf\": [\n                {\n                    \"type\": \"string\"\n                },\n                {\n                    \"type\": \"null\"\n                }\n            ],\n            \"title\": \"Description\"\n        },\n        \"attribution\": {\n            \"anyOf\": [\n                {\n                    \"type\": \"string\"\n                },\n                {\n                    \"type\": \"null\"\n                }\n            ],\n            \"title\": \"Attribution\"\n        },\n        \"url\": {\n            \"anyOf\": [\n                {\n                    \"type\": \"string\"\n                },\n                {\n                    \"type\": \"null\"\n                }\n            ],\n            \"title\": \"Url\"\n        },\n        \"config\": {\n            \"anyOf\": [\n                {\n                    \"additionalProperties\": true,\n                    \"type\": \"object\"\n                },\n                {\n                    \"type\": \"null\"\n                }\n            ],\n            \"title\": \"Config\"\n        },\n        \"props_schema\": {\n            \"anyOf\": [\n                {\n                    \"additionalProperties\": true,\n                    \"type\": \"object\"\n                },\n                {\n                    \"type\": \"null\"\n                }\n            ],\n            \"title\": \"Props Schema\"\n        },\n        \"order\": {\n            \"anyOf\": [\n                {\n                    \"type\": \"integer\"\n                },\n                {\n                    \"type\": \"null\"\n                }\n            ],\n            \"title\": \"Order\"\n        },\n        \"slug\": {\n            \"anyOf\": [\n                {\n                    \"type\": \"string\"\n                },\n                {\n                    \"type\": \"null\"\n                }\n            ],\n            \"title\": \"Slug\"\n        },\n        \"link_hut_pattern\": {\n            \"anyOf\": [\n                {\n                    \"maxLength\": 300,\n                    \"type\": \"string\"\n                },\n                {\n                    \"type\": \"null\"\n                }\n            ],\n            \"description\": \"Link pattern to corresponding object. Variables to use: {{id}}, {{lang}}, {{props}}, {{config}}.)\",\n            \"title\": \"Link patten to object\"\n        },\n        \"logo\": {\n            \"anyOf\": [\n                {\n                    \"maxLength\": 300,\n                    \"type\": \"string\"\n                },\n                {\n                    \"type\": \"null\"\n                }\n            ],\n            \"default\": \"organizations/logos/missing.png\",\n            \"description\": \"Organiztion logo as image\",\n            \"title\": \"Logo\"\n        },\n        \"is_active\": {\n            \"anyOf\": [\n                {\n                    \"type\": \"boolean\"\n                },\n                {\n                    \"type\": \"null\"\n                }\n            ],\n            \"default\": true,\n            \"title\": \"Aktiv\"\n        },\n        \"is_public\": {\n            \"anyOf\": [\n                {\n                    \"type\": \"boolean\"\n                },\n                {\n                    \"type\": \"null\"\n                }\n            ],\n            \"default\": false,\n            \"title\": \"Public\"\n        },\n        \"color_light\": {\n            \"anyOf\": [\n                {\n                    \"maxLength\": 25,\n                    \"type\": \"string\"\n                },\n                {\n                    \"type\": \"null\"\n                }\n            ],\n            \"default\": \"#4B8E43\",\n            \"description\": \"light theme color as hex number with #\",\n            \"title\": \"Light Color\"\n        },\n        \"color_dark\": {\n            \"anyOf\": [\n                {\n                    \"maxLength\": 25,\n                    \"type\": \"string\"\n                },\n                {\n                    \"type\": \"null\"\n                }\n            ],\n            \"default\": \"#61B958\",\n            \"description\": \"dark theme color as hex number with #\",\n            \"title\": \"Dark Color\"\n        }\n    },\n    \"required\": [\n        \"name\"\n    ],\n    \"title\": \"OrganizationOptional\",\n    \"type\": \"object\"\n}\n</code></pre>"},{"location":"api/#feedback","title":"feedback","text":""},{"location":"api/#post-v1feedback","title":"POST /v1/feedback/","text":"<p>Create Feedback</p> <p>Input parameters</p> Parameter In Type Default Nullable Description <code>send_email</code> query boolean True No <p>Request body</p> application/json <p><pre><code>{\n    \"urls\": null,\n    \"email\": \"string\",\n    \"subject\": \"string\",\n    \"message\": \"string\",\n    \"get_updates\": true\n}\n</code></pre> \u26a0\ufe0f This example has been generated automatically from the schema and it is not accurate. Refer to the schema for more information.</p> Schema of the request body <pre><code>{\n    \"properties\": {\n        \"urls\": {\n            \"anyOf\": [\n                {\n                    \"items\": {\n                        \"type\": \"string\"\n                    },\n                    \"type\": \"array\"\n                },\n                {\n                    \"type\": \"null\"\n                }\n            ],\n            \"title\": \"Urls\"\n        },\n        \"email\": {\n            \"title\": \"Email\",\n            \"type\": \"string\"\n        },\n        \"subject\": {\n            \"title\": \"Subject\",\n            \"type\": \"string\"\n        },\n        \"message\": {\n            \"title\": \"Message\",\n            \"type\": \"string\"\n        },\n        \"get_updates\": {\n            \"title\": \"Get Updates\",\n            \"type\": \"boolean\"\n        }\n    },\n    \"required\": [\n        \"email\",\n        \"subject\",\n        \"message\",\n        \"get_updates\"\n    ],\n    \"title\": \"FeedbackCreate\",\n    \"type\": \"object\"\n}\n</code></pre> <p> Response 200 OK </p> application/json <p><pre><code>{\n    \"message\": \"string\",\n    \"id\": 0\n}\n</code></pre> \u26a0\ufe0f This example has been generated automatically from the schema and it is not accurate. Refer to the schema for more information.</p> Schema of the response body <pre><code>{\n    \"properties\": {\n        \"message\": {\n            \"title\": \"Message\",\n            \"type\": \"string\"\n        },\n        \"id\": {\n            \"title\": \"Id\",\n            \"type\": \"integer\"\n        }\n    },\n    \"required\": [\n        \"message\",\n        \"id\"\n    ],\n    \"title\": \"ResponseSchema\",\n    \"type\": \"object\"\n}\n</code></pre>"},{"location":"api/#utils","title":"utils","text":""},{"location":"api/#get-v1version","title":"GET /v1/version","text":"<p>Get Version</p> Description <p>Get version information including git hash, package version, build timestamp, and environment.</p> <p> Response 200 OK </p> application/json <p><pre><code>{\n    \"hash\": \"abc123e\",\n    \"version\": \"1.2.0\",\n    \"timestamp\": \"2022-04-13T15:42:05.901Z\",\n    \"environment\": \"production\"\n}\n</code></pre> \u26a0\ufe0f This example has been generated automatically from the schema and it is not accurate. Refer to the schema for more information.</p> Schema of the response body <pre><code>{\n    \"properties\": {\n        \"hash\": {\n            \"description\": \"Git commit hash\",\n            \"example\": \"abc123e\",\n            \"title\": \"Hash\",\n            \"type\": \"string\"\n        },\n        \"version\": {\n            \"description\": \"Sematic version\",\n            \"example\": \"1.2.0\",\n            \"title\": \"Version\",\n            \"type\": \"string\"\n        },\n        \"timestamp\": {\n            \"description\": \"Build timestamp\",\n            \"format\": \"date-time\",\n            \"title\": \"Timestamp\",\n            \"type\": \"string\"\n        },\n        \"environment\": {\n            \"description\": \"Current environment (development, production)\",\n            \"example\": \"production\",\n            \"title\": \"Environment\",\n            \"type\": \"string\"\n        }\n    },\n    \"required\": [\n        \"hash\",\n        \"version\",\n        \"timestamp\",\n        \"environment\"\n    ],\n    \"title\": \"VersionSchema\",\n    \"type\": \"object\"\n}\n</code></pre>"},{"location":"api/#schemas","title":"Schemas","text":""},{"location":"api/#answerenum","title":"AnswerEnum","text":"<p>Type: string</p>"},{"location":"api/#availabilitydayschema","title":"AvailabilityDaySchema","text":"Name Type <code>date</code> string(date) <code>free</code> integer <code>hut_type</code> string <code>occupancy_percent</code> number <code>occupancy_status</code> OccupancyStatusEnum <code>occupancy_steps</code> integer <code>reservation_status</code> ReservationStatusEnum <code>total</code> integer"},{"location":"api/#availabilitygeojsonquery","title":"AvailabilityGeoJSONQuery","text":"Name Type <code>days</code> integer <code>limit</code> <code>offset</code> integer <code>slugs</code>"},{"location":"api/#availabilitytrenddayschema","title":"AvailabilityTrendDaySchema","text":"Name Type <code>date</code> string(date) <code>first_checked</code> string(date-time) <code>free</code> integer <code>hut_type</code> string <code>last_checked</code> string(date-time) <code>occupancy_percent</code> number <code>occupancy_status</code> OccupancyStatusEnum <code>reservation_status</code> ReservationStatusEnum <code>total</code> integer"},{"location":"api/#availabilitytrendquery","title":"AvailabilityTrendQuery","text":"Name Type <code>limit</code> integer"},{"location":"api/#availabilitytrendschema","title":"AvailabilityTrendSchema","text":"Name Type <code>data</code> Array&lt;AvailabilityTrendDaySchema&gt; <code>id</code> integer <code>period_end</code> string(date) <code>period_start</code> string(date) <code>slug</code> string <code>target_date</code> string(date)"},{"location":"api/#basemodel","title":"BaseModel","text":""},{"location":"api/#capacitysimpleschema","title":"CapacitySimpleSchema","text":"Name Type <code>closed</code> <code>open</code>"},{"location":"api/#countrytuple","title":"CountryTuple","text":"<p>Type: Array&lt;&gt;</p>"},{"location":"api/#currentavailabilitydayschema","title":"CurrentAvailabilityDaySchema","text":"Name Type <code>date</code> string(date) <code>first_checked</code> string(date-time) <code>free</code> integer <code>hut_type</code> string <code>last_checked</code> string(date-time) <code>link</code> string <code>occupancy_percent</code> number <code>occupancy_status</code> OccupancyStatusEnum <code>occupancy_steps</code> integer <code>reservation_status</code> ReservationStatusEnum <code>total</code> integer"},{"location":"api/#currentavailabilityquery","title":"CurrentAvailabilityQuery","text":"Name Type <code>days</code> integer"},{"location":"api/#currentavailabilityschema","title":"CurrentAvailabilitySchema","text":"Name Type <code>data</code> Array&lt;CurrentAvailabilityDaySchema&gt; <code>days</code> integer <code>id</code> integer <code>slug</code> string <code>source</code> string <code>source_id</code> string <code>source_link</code> string <code>start_date</code> string(date)"},{"location":"api/#datepathparam","title":"DatePathParam","text":"Name Type <code>date</code> string"},{"location":"api/#datepathparamtrend","title":"DatePathParamTrend","text":"Name Type <code>date</code> string"},{"location":"api/#feature","title":"Feature","text":"Name Type <code>bbox</code> <code>geometry</code> <code>id</code> <code>properties</code> <code>type</code> string"},{"location":"api/#feature_point_hutavailabilitypropertiesschema_","title":"Feature_Point_HutAvailabilityPropertiesSchema_","text":"Name Type <code>bbox</code> <code>geometry</code> <code>id</code> <code>properties</code> <code>type</code> string"},{"location":"api/#feature_point_hutbookingsprops_","title":"Feature_Point_HutBookingsProps_","text":"Name Type <code>bbox</code> <code>geometry</code> <code>id</code> <code>properties</code> <code>type</code> string"},{"location":"api/#featurecollection","title":"FeatureCollection","text":"Name Type <code>bbox</code> <code>features</code> Array&lt;Feature&gt; <code>type</code> string"},{"location":"api/#feedbackcreate","title":"FeedbackCreate","text":"Name Type <code>email</code> string <code>get_updates</code> boolean <code>message</code> string <code>subject</code> string <code>urls</code>"},{"location":"api/#fieldsparam_hutschemadetails_","title":"FieldsParam_HutSchemaDetails_","text":"Name Type <code>exclude</code> <code>include</code>"},{"location":"api/#fieldsparam_huttypedetailschema_","title":"FieldsParam_HutTypeDetailSchema_","text":"Name Type <code>exclude</code> <code>include</code>"},{"location":"api/#fieldsparam_organizationoptional_","title":"FieldsParam_OrganizationOptional_","text":"Name Type <code>exclude</code> <code>include</code>"},{"location":"api/#geometrycollection","title":"GeometryCollection","text":"Name Type <code>bbox</code> <code>geometries</code> Array&lt;&gt; <code>type</code> string"},{"location":"api/#hutavailabilityfeaturecollection","title":"HutAvailabilityFeatureCollection","text":"Name Type <code>bbox</code> <code>features</code> Array&lt;Feature_Point_HutAvailabilityPropertiesSchema_&gt; <code>type</code> string"},{"location":"api/#hutavailabilitypropertiesschema","title":"HutAvailabilityPropertiesSchema","text":"Name Type <code>data</code> Array&lt;AvailabilityDaySchema&gt; <code>days</code> integer <code>id</code> integer <code>slug</code> string <code>source</code> string <code>source_id</code> string <code>source_link</code> string <code>start_date</code> string(date)"},{"location":"api/#hutbookingschema","title":"HutBookingSchema","text":"Name Type <code>date</code> string(date) <code>free</code> integer <code>hut_type</code> string <code>link</code> string <code>occupancy_percent</code> number <code>occupancy_status</code> OccupancyStatusEnum <code>occupancy_steps</code> integer <code>reservation_status</code> ReservationStatusEnum <code>total</code> integer"},{"location":"api/#hutbookingsfeaturecollection","title":"HutBookingsFeatureCollection","text":"Name Type <code>bbox</code> <code>features</code> Array&lt;Feature_Point_HutBookingsProps_&gt; <code>type</code> string"},{"location":"api/#hutbookingsprops","title":"HutBookingsProps","text":"Name Type <code>bookings</code> Array&lt;HutBookingSchema&gt; <code>days</code> integer <code>hut_id</code> integer <code>link</code> string <code>slug</code> string <code>source</code> string <code>source_id</code> string <code>start_date</code> string(date)"},{"location":"api/#hutbookingsquery","title":"HutBookingsQuery","text":"Name Type <code>date</code> <code>days</code> integer <code>request_interval</code> <code>slugs</code>"},{"location":"api/#hutbookingsschema","title":"HutBookingsSchema","text":"Name Type <code>bookings</code> Array&lt;HutBookingSchema&gt; <code>days</code> integer <code>hut_id</code> integer <code>link</code> string <code>location</code> LocationSchema <code>slug</code> string <code>source</code> string <code>source_id</code> string <code>start_date</code> string(date)"},{"location":"api/#hutschemadetails","title":"HutSchemaDetails","text":"Name Type <code>availability_source</code> <code>capacity_closed</code> <code>capacity_open</code> <code>country</code> <code>created</code> <code>description</code> <code>description_attribution</code> string <code>edit_link</code> <code>elevation</code> <code>has_availability</code> <code>images</code> <code>is_active</code> <code>is_modified</code> <code>is_public</code> <code>location</code> <code>modified</code> <code>name</code> <code>open_monthly</code> <code>owner</code> <code>photos</code> string <code>photos_attribution</code> string <code>review_status</code> <code>slug</code> string <code>sources</code> <code>translations</code> <code>type_closed</code> <code>type_open</code> <code>url</code>"},{"location":"api/#hutschemalist","title":"HutSchemaList","text":"Name Type <code>availability_source</code> <code>capacity_closed</code> <code>capacity_open</code> <code>country</code> <code>description</code> <code>description_attribution</code> string <code>elevation</code> <code>has_availability</code> <code>images</code> <code>is_active</code> <code>is_modified</code> <code>is_public</code> <code>location</code> <code>name</code> <code>open_monthly</code> <code>owner</code> <code>photos</code> string <code>photos_attribution</code> string <code>review_status</code> <code>slug</code> string <code>sources</code> <code>type_closed</code> <code>type_open</code> <code>url</code>"},{"location":"api/#hutsearchresultschema","title":"HutSearchResultSchema","text":"Name Type <code>avatar</code> <code>capacity</code> CapacitySimpleSchema <code>elevation</code> <code>hut_type</code> <code>location</code> LocationSchema <code>name</code> string <code>score</code> number <code>slug</code> string <code>sources</code>"},{"location":"api/#huttypedetailschema","title":"HutTypeDetailSchema","text":"Name Type <code>description</code> string <code>icon</code> <code>level</code> <code>name</code> string <code>slug</code> string <code>symbol</code> <code>symbol_simple</code>"},{"location":"api/#huttypeschema","title":"HutTypeSchema","text":"Name Type <code>icon</code> <code>level</code> <code>name</code> <code>slug</code> string <code>symbol</code> <code>symbol_simple</code>"},{"location":"api/#imageinfoschema","title":"ImageInfoSchema","text":"Name Type <code>attribution</code> <code>author</code> <code>author_url</code> <code>caption</code> <code>image</code> string <code>image_meta</code> ImageMetaSchema <code>license</code> LicenseInfoSchema <code>organization</code> <code>source_url</code> <code>urls</code>"},{"location":"api/#imagemetaareaschema","title":"ImageMetaAreaSchema","text":"Name Type <code>x1</code> number <code>x2</code> number <code>y1</code> number <code>y2</code> number"},{"location":"api/#imagemetaschema","title":"ImageMetaSchema","text":"Name Type <code>crop</code> <code>focal</code> <code>height</code> <code>width</code>"},{"location":"api/#includemodeenum","title":"IncludeModeEnum","text":"<p>Type: string</p>"},{"location":"api/#licenseinfoschema","title":"LicenseInfoSchema","text":"Name Type <code>description</code> <code>fullname</code> <code>link</code> <code>name</code> <code>slug</code> string"},{"location":"api/#linestring","title":"LineString","text":"Name Type <code>bbox</code> <code>coordinates</code> Array&lt;&gt; <code>type</code> string"},{"location":"api/#locationschema","title":"LocationSchema","text":"Name Type <code>lat</code> number <code>lon</code> number"},{"location":"api/#multilinestring","title":"MultiLineString","text":"Name Type <code>bbox</code> <code>coordinates</code> Array&lt;Array&lt;&gt;&gt; <code>type</code> string"},{"location":"api/#multipoint","title":"MultiPoint","text":"Name Type <code>bbox</code> <code>coordinates</code> Array&lt;&gt; <code>type</code> string"},{"location":"api/#multipolygon","title":"MultiPolygon","text":"Name Type <code>bbox</code> <code>coordinates</code> Array&lt;Array&lt;Array&lt;&gt;&gt;&gt; <code>type</code> string"},{"location":"api/#occupancystatusenum","title":"OccupancyStatusEnum","text":"<p>Type: string</p>"},{"location":"api/#openmonthlyschema","title":"OpenMonthlySchema","text":"Name Type <code>month_01</code> <code>month_02</code> <code>month_03</code> <code>month_04</code> <code>month_05</code> <code>month_06</code> <code>month_07</code> <code>month_08</code> <code>month_09</code> <code>month_10</code> <code>month_11</code> <code>month_12</code> <code>url</code> string"},{"location":"api/#organizationbaseschema","title":"OrganizationBaseSchema","text":"Name Type <code>fullname</code> string <code>link</code> string <code>logo</code> string <code>name</code> string <code>public</code> boolean <code>slug</code> string <code>source_id</code> string"},{"location":"api/#organizationimageschema","title":"OrganizationImageSchema","text":"Name Type <code>fullname</code> <code>link</code> <code>logo</code> <code>name</code> <code>slug</code>"},{"location":"api/#organizationoptional","title":"OrganizationOptional","text":"Name Type <code>attribution</code> <code>color_dark</code> <code>color_light</code> <code>config</code> <code>description</code> <code>fullname</code> <code>is_active</code> <code>is_public</code> <code>link_hut_pattern</code> <code>logo</code> <code>name</code> <code>order</code> <code>props_schema</code> <code>slug</code> <code>url</code>"},{"location":"api/#ownerschema","title":"OwnerSchema","text":"Name Type <code>name</code> <code>slug</code> string <code>url</code>"},{"location":"api/#point","title":"Point","text":"Name Type <code>bbox</code> <code>coordinates</code> <code>type</code> string"},{"location":"api/#polygon","title":"Polygon","text":"Name Type <code>bbox</code> <code>coordinates</code> Array&lt;Array&lt;&gt;&gt; <code>type</code> string"},{"location":"api/#position2d","title":"Position2D","text":"<p>Type: Array&lt;&gt;</p>"},{"location":"api/#position3d","title":"Position3D","text":"<p>Type: Array&lt;&gt;</p>"},{"location":"api/#reservationstatusenum","title":"ReservationStatusEnum","text":"<p>Type: string</p>"},{"location":"api/#responseschema","title":"ResponseSchema","text":"Name Type <code>id</code> integer <code>message</code> string"},{"location":"api/#tristateenum","title":"TristateEnum","text":"<p>Type: string</p>"},{"location":"api/#versionschema","title":"VersionSchema","text":"Name Type <code>environment</code> string <code>hash</code> string <code>timestamp</code> string(date-time) <code>version</code> string"},{"location":"changelog/","title":"Changelog","text":""},{"location":"changelog/#changelog","title":"Changelog","text":"<p>All notable changes to this project will be documented in this file.</p> <p>The format is based on Keep a Changelog, and this project adheres to Semantic Versioning.</p>"},{"location":"changelog/#0113-2026-01-22","title":"0.1.13 - 2026-01-22","text":""},{"location":"changelog/#fixes","title":"\ud83d\udc1b Fixes","text":"<ul> <li>Fix geoplace import for wodore (#86)</li> </ul>"},{"location":"changelog/#0112-2026-01-22","title":"0.1.12 - 2026-01-22","text":""},{"location":"changelog/#breaking-changes","title":"\ud83c\udfd7\ufe0f Breaking changes","text":"<ul> <li>Update symbol references (#66)</li> </ul>"},{"location":"changelog/#features","title":"\ud83d\ude80 Features","text":"<ul> <li>Add meteo app (#83)</li> <li>Improve search performance and import geonames command (#78, #77)</li> <li>Include long git hash in version information (#76)</li> <li>Add symbols table (#65)</li> <li>Add hut type <code>symbol_detailed</code> and <code>symbol_simple</code> for hut search (#62)</li> </ul>"},{"location":"changelog/#fixes_1","title":"\ud83d\udc1b Fixes","text":"<ul> <li>Migrations for hut and category failed due to country contstains (#75)</li> <li>Fix availability script. Add GeoNames organization. (#73)</li> <li>Fix add symbols migration (#72)</li> <li>Fix geometries.0002 migration to run after symbol migration completes (#71)</li> <li>Fix external_geonames.0002 migration to use migration-safe model access (#70)</li> <li>Fix migration ordering to ensure HutTypes are copied before FK constraints (#69)</li> </ul>"},{"location":"changelog/#others","title":"\ud83c\udf00 Others","text":"<ul> <li>Use correct utc timestamp for docker builds (#74)</li> <li>Docker build fail fast (#68)</li> </ul>"},{"location":"changelog/#0111-2026-01-06","title":"0.1.11 - 2026-01-06","text":""},{"location":"changelog/#features_1","title":"\ud83d\ude80 Features","text":"<ul> <li>Add search endpoint (#60)</li> <li>Add staging environment with staging email backend. (#59)</li> <li>Add <code>version</code> endpoint (#55)</li> <li>Add <code>has_availablity</code>, <code>modified</code>, and <code>created</code> field to hut details. Add etags for hut endpoints. (#54)</li> <li>Improve <code>get_hut_geosjon</code>: optimize db query (#49)</li> <li>Add new <code>huts/availability.geojson</code> endpoint with improved performance (#46)</li> <li>Add parameter env variables for update_availability script (#45)</li> </ul>"},{"location":"changelog/#fixes_2","title":"\ud83d\udc1b Fixes","text":"<ul> <li>Copy pyproject.toml in Dockerfile to have the correct version. (#57)</li> <li>Fix availability query issues (#51)</li> <li>Include source_id for hut details (#48)</li> <li>Improve 'modified' field with postgres native trigger. Add django-pgtrigger. (#44)</li> </ul>"},{"location":"changelog/#refactor","title":"\ud83c\udfed Refactor","text":"<ul> <li>Improve availability endpoints. Use date in path. (#47)</li> </ul>"},{"location":"changelog/#others_1","title":"\ud83c\udf00 Others","text":"<ul> <li>Speed up quality workflow (#53)</li> <li>Add timestamp to hash tag (sortable) (#52)</li> <li>Improve docker build pipeline (#50)</li> </ul>"},{"location":"changelog/#0110-2026-01-01","title":"0.1.10 - 2026-01-01","text":""},{"location":"changelog/#breaking-changes_1","title":"\ud83c\udfd7\ufe0f Breaking changes","text":"<ul> <li>Add availability tables, commands and admin views. Uddate get_booking api endpoint. (#36)</li> </ul>"},{"location":"changelog/#features_2","title":"\ud83d\ude80 Features","text":"<ul> <li>Update oidc header for auth calls. Extend session login time to 7 days. (#38)</li> <li>Add internal oidc url with external url as header (optional) (#37)</li> <li>No error on missing images, add S3 storage (#30)</li> </ul>"},{"location":"changelog/#fixes_3","title":"\ud83d\udc1b Fixes","text":"<ul> <li>Improve parameter updates during oidc flow (#40)</li> <li>Fix oidc issues (#39)</li> <li>Follow redirects. Improve imagor hashes. (#32)</li> <li>Fix imagor signing issue and redirect urls (#29)</li> </ul>"},{"location":"changelog/#refactor_1","title":"\ud83c\udfed Refactor","text":"<ul> <li>Fix hrs booking, use default request_intervall parameter (#33)</li> <li>Replace wodore.com with wodo.re (#28)</li> </ul>"},{"location":"changelog/#documentation","title":"\ud83d\udcdd Documentation","text":"<ul> <li>Add informations (links) to documentation: https://wodore.github.io/wodore-backend/infos/ (#31)</li> <li>Add OpenApi documentation (#27)</li> </ul>"},{"location":"changelog/#019-2025-08-21","title":"0.1.9 - 2025-08-21","text":"<p>Initial release.</p>"},{"location":"changelog/#features_3","title":"\ud83d\ude80 Features","text":"<ul> <li>Ignore connection error oicd (#16)</li> <li>Open monthly formfield and green for empty huts (#10)</li> </ul>"},{"location":"changelog/#fixes_4","title":"\ud83d\udc1b Fixes","text":"<ul> <li>Fix frontend hut link (#11)</li> <li>Fix hut location field missing (#8)</li> </ul>"},{"location":"changelog/#dependencies","title":"\ud83e\uddea Dependencies","text":"<ul> <li>Update python packages (#12, #13, #18)</li> </ul>"},{"location":"changelog/#others_2","title":"\ud83c\udf00 Others","text":"<ul> <li>Include git hash in docker build (#19)</li> <li>Use <code>READ_DOCKER_TOKEN</code> and <code>READ_DOCKER_USER</code> for private repo access during docker build. (#5)</li> <li>Add docker invoke scripts (#4)</li> <li>Switch from <code>poetry</code> to <code>uv</code> (#1)</li> </ul>"},{"location":"infos/","title":"Links","text":"<p>Useful links  hut informations and development.</p> Hut Development"},{"location":"infos/#hut-reservation","title":"Hut Reservation","text":"<ul> <li> Alpsonline</li> <li> Deine Berge</li> <li> H\u00fctten-Holiday</li> <li> AlpinRes</li> </ul>"},{"location":"infos/#hut-information","title":"Hut Information","text":"<ul> <li> SAC</li> <li> Refuges.info</li> <li> Gipfelbuch</li> <li> Naturfreunde Schweiz</li> <li> Open Street Map</li> <li> Camptocamp</li> <li> Wikidata</li> <li> wodore</li> </ul>"},{"location":"infos/#hosting","title":"Hosting","text":"<ul> <li>Infomaniak</li> </ul>"},{"location":"infos/#python-packages","title":"Python Packages","text":"<ul> <li>hut-services</li> <li>imgora</li> </ul>"},{"location":"infos/#django","title":"Django","text":"<ul> <li>Django</li> <li>django ninja</li> <li>unfold admin</li> </ul>"},{"location":"infos/#database","title":"Database","text":"<ul> <li>PostgreSQL</li> <li>PostGIS</li> </ul>"},{"location":"infos/#image-processing","title":"Image Processing","text":"<ul> <li>Imagor</li> <li>wsrv</li> </ul>"},{"location":"infos/#authentication-user-management","title":"Authentication, User Management","text":"<ul> <li>Zitadel</li> </ul>"},{"location":"infos/#development-tools","title":"Development Tools","text":"<ul> <li>uv for package management</li> <li>infisical for secrets management (optional)</li> <li>invoke</li> </ul>"},{"location":"infos/#docker","title":"Docker","text":"<ul> <li>docker for containerization</li> <li>docker compose for multi-container applications</li> </ul>"},{"location":"infos/#_1","title":"Links","text":""},{"location":"packages/","title":"Packages","text":""},{"location":"packages/#docker","title":"Docker","text":"<p>Docker images are created with the following tags:</p> <ul> <li><code>latest</code>: latest stable version</li> <li><code>major</code>, <code>major.minor</code> and <code>major.minor.rev</code> tags</li> <li><code>sha-HASH</code>: git hash of the commit used for the build</li> <li><code>edge</code>: unstable development version</li> </ul> <p>Each tag is suffixed with the used distro (e.g. <code>alpine</code> or <code>ubuntu</code>). Per default only <code>alpine</code> is generated.</p> Docker ComposeDocker <p>It is recommended to use <code>docker compose</code>:</p> <p>Example docker compose fil with two databases and a backup runner container<pre><code>services:\n  wodore-backend:\n    image: ghcr.io/wodore/wodore-backend:latest\n    restart: unless-stopped\n    container_name: wodore-backend\n</code></pre> Run a custom command:</p> <pre><code>$ docker compose up # start services\n$ docker compose run wodore-backend [OPTIONS] COMMAND [ARGS]... # (1)!\n</code></pre> <ol> <li>Run <code>db-backup-runner</code> subcommands.</li> </ol> <p>It is also possible to run it with docker directly:</p> Pull latest docker image<pre><code>$ docker pull ghcr.io/wodore/wodore-backend:latest\n$ docker run --rm -it ghcr.io/wodore/wodore-backend:latest\n</code></pre>"},{"location":"weps/","title":"Wodore Enhancement Proposals","text":"<p>Technical enhancement proposals for the Wodore backend.</p>"},{"location":"weps/tags/","title":"Tags","text":""},{"location":"weps/tags/#tag:wep002","title":"WEP002","text":"<ul> <li>            WEP 2 Hut Access Classification          </li> </ul>"},{"location":"weps/tags/#tag:wep003","title":"WEP003","text":"<ul> <li>            WEP 3 Public Transport Access          </li> </ul>"},{"location":"weps/tags/#tag:wep004","title":"WEP004","text":"<ul> <li>            WEP 4 Routing on External Data Sources          </li> </ul>"},{"location":"weps/tags/#tag:wep005","title":"WEP005","text":"<ul> <li>            WEP 5 Hut Access Isochrones          </li> </ul>"},{"location":"weps/tags/#tag:accessibility","title":"accessibility","text":"<ul> <li>            WEP 2 Hut Access Classification          </li> <li>            WEP 3 Public Transport Access          </li> <li>            WEP 5 Hut Access Isochrones          </li> </ul>"},{"location":"weps/tags/#tag:classification","title":"classification","text":"<ul> <li>            WEP 2 Hut Access Classification          </li> </ul>"},{"location":"weps/tags/#tag:data-integration","title":"data-integration","text":"<ul> <li>            WEP 4 Routing on External Data Sources          </li> </ul>"},{"location":"weps/tags/#tag:graphhopper","title":"graphhopper","text":"<ul> <li>            WEP 1 Routing Service          </li> </ul>"},{"location":"weps/tags/#tag:gtfs","title":"gtfs","text":"<ul> <li>            WEP 1 Routing Service          </li> <li>            WEP 3 Public Transport Access          </li> </ul>"},{"location":"weps/tags/#tag:hiking","title":"hiking","text":"<ul> <li>            WEP 4 Routing on External Data Sources          </li> </ul>"},{"location":"weps/tags/#tag:huts","title":"huts","text":"<ul> <li>            WEP 2 Hut Access Classification          </li> <li>            WEP 3 Public Transport Access          </li> <li>            WEP 5 Hut Access Isochrones          </li> </ul>"},{"location":"weps/tags/#tag:isochrones","title":"isochrones","text":"<ul> <li>            WEP 1 Routing Service          </li> <li>            WEP 2 Hut Access Classification          </li> <li>            WEP 5 Hut Access Isochrones          </li> </ul>"},{"location":"weps/tags/#tag:osm","title":"osm","text":"<ul> <li>            WEP 4 Routing on External Data Sources          </li> </ul>"},{"location":"weps/tags/#tag:postgis","title":"postgis","text":"<ul> <li>            WEP 5 Hut Access Isochrones          </li> </ul>"},{"location":"weps/tags/#tag:postgresql","title":"postgresql","text":"<ul> <li>            WEP 6 ParadeDB Integration for Advanced Search          </li> </ul>"},{"location":"weps/tags/#tag:public-transport","title":"public-transport","text":"<ul> <li>            WEP 3 Public Transport Access          </li> </ul>"},{"location":"weps/tags/#tag:routing","title":"routing","text":"<ul> <li>            WEP 1 Routing Service          </li> <li>            WEP 2 Hut Access Classification          </li> <li>            WEP 3 Public Transport Access          </li> <li>            WEP 4 Routing on External Data Sources          </li> <li>            WEP 5 Hut Access Isochrones          </li> </ul>"},{"location":"weps/tags/#tag:search","title":"search","text":"<ul> <li>            WEP 6 ParadeDB Integration for Advanced Search          </li> </ul>"},{"location":"weps/tags/#tag:ski-touring","title":"ski-touring","text":"<ul> <li>            WEP 4 Routing on External Data Sources          </li> </ul>"},{"location":"weps/tags/#tag:swisstopo","title":"swisstopo","text":"<ul> <li>            WEP 4 Routing on External Data Sources          </li> </ul>"},{"location":"weps/tags/#tag:valhalla","title":"valhalla","text":"<ul> <li>            WEP 1 Routing Service          </li> </ul>"},{"location":"weps/tags/#tag:weather","title":"weather","text":"<ul> <li>            WEP 7 Weather Forecast          </li> </ul>"},{"location":"weps/tags/#tag:wep001","title":"wep001","text":"<ul> <li>            WEP 1 Routing Service          </li> </ul>"},{"location":"weps/tags/#tag:wep006","title":"wep006","text":"<ul> <li>            WEP 6 ParadeDB Integration for Advanced Search          </li> </ul>"},{"location":"weps/tags/#tag:wep007","title":"wep007","text":"<ul> <li>            WEP 7 Weather Forecast          </li> </ul>"},{"location":"weps/wep001/","title":"<code>WEP 1</code> Routing Service","text":"<p>Core routing engine selection and architecture for Alpine accessibility analysis.</p>","tags":["wep001","routing","graphhopper","valhalla","gtfs","isochrones"]},{"location":"weps/wep001/#requirements","title":"Requirements","text":"<ul> <li>Support for transit data (GTFS) with time-dependent routing</li> <li>Strong support for outdoor profiles (hiking, biking, ski touring)</li> <li>Ability to integrate external data sources (e.g. Swisstopo hiking trails, ski routes)</li> <li>Custom routing profiles and weighting (e.g. prefer ski routes, hiking difficulty)</li> <li>Low memory consumption during graph build and runtime (&lt; 4 GB target)</li> <li>Isochrone generation, including transit isochrones</li> <li>Matrix calculations (one-to-many, many-to-many)</li> </ul>","tags":["wep001","routing","graphhopper","valhalla","gtfs","isochrones"]},{"location":"weps/wep001/#options","title":"Options","text":"","tags":["wep001","routing","graphhopper","valhalla","gtfs","isochrones"]},{"location":"weps/wep001/#valhalla","title":"Valhalla","text":"<p>Overview Valhalla is a tile-based routing engine developed by Mapbox, with strong native support for multimodal and public transport routing.</p> <p>Advantages</p> <ul> <li>First-class GTFS transit routing and transit isochrones</li> <li>Very efficient runtime performance for transit queries</li> <li>Tile-based architecture allows partial loading at runtime</li> <li>Good default support for car, bike, and pedestrian routing</li> </ul> <p>Limitations</p> <ul> <li>GTFS data is baked into transit tiles and must be rebuilt on update</li> <li>Frequent GTFS updates are operationally expensive</li> <li>Custom outdoor profiles (e.g. ski touring) require C++ costing model changes</li> <li>Integration of external vector data is complex</li> </ul> <p>Link https://github.com/valhalla/valhalla</p>","tags":["wep001","routing","graphhopper","valhalla","gtfs","isochrones"]},{"location":"weps/wep001/#graphhopper","title":"GraphHopper","text":"<p>Overview GraphHopper is a flexible Java-based routing engine with strong support for custom profiles, external data, and precomputation workflows.</p> <p>Advantages</p> <ul> <li>Excellent support for custom profiles via Custom Models (YAML)</li> <li> <p>Clear separation between:</p> </li> <li> <p>Hard profiles (encoded values, schema, external data \u2013 require rebuild)</p> </li> <li>Soft profiles (weighting and preferences \u2013 no rebuild required)</li> <li>Can integrate external vector data (e.g. Swisstopo hiking and ski routes)</li> <li>Supports isochrones and matrix routing (one-to-many, many-to-many)</li> <li>GTFS transit data is preprocessed offline and loaded at startup</li> <li>Allows frequent GTFS updates without rebuilding the road graph</li> <li>Lower memory footprint than Valhalla for non-transit-heavy use cases</li> <li>Well suited for static precomputation (hut isochrones, reachability)</li> </ul> <p>Limitations</p> <ul> <li>Transit isochrones are less mature and slower than Valhalla</li> <li>GTFS updates still require preprocessing</li> <li>New tags or schema changes require a graph rebuild</li> </ul> <p>Link https://github.com/graphhopper/graphhopper</p>","tags":["wep001","routing","graphhopper","valhalla","gtfs","isochrones"]},{"location":"weps/wep001/#brouter","title":"BRouter","text":"<p>Overview BRouter is a lightweight routing engine focused on biking and hiking, widely used in outdoor navigation tools.</p> <p>Advantages</p> <ul> <li>Very low memory usage</li> <li>Highly flexible programmable profiles</li> <li>Excellent routing quality for hiking and biking</li> <li>Fast for single-route calculations</li> </ul> <p>Limitations</p> <ul> <li>No native support for transit</li> <li>No isochrones or matrix calculations</li> <li>Limited API and server-side capabilities</li> </ul> <p>Link https://github.com/abrensch/brouter</p>","tags":["wep001","routing","graphhopper","valhalla","gtfs","isochrones"]},{"location":"weps/wep001/#other-options-brief","title":"Other Options (Brief)","text":"","tags":["wep001","routing","graphhopper","valhalla","gtfs","isochrones"]},{"location":"weps/wep001/#pgrouting","title":"pgRouting","text":"<ul> <li>PostgreSQL-based routing extension</li> <li>Useful for custom graph experiments</li> <li>Not suitable for large-scale or transit routing</li> </ul> <p>Link: https://pgrouting.org/</p>","tags":["wep001","routing","graphhopper","valhalla","gtfs","isochrones"]},{"location":"weps/wep001/#opentripplanner-otp","title":"OpenTripPlanner (OTP)","text":"<ul> <li>Strong public transport routing</li> <li>Heavy memory requirements</li> <li>Less flexible for custom outdoor profiles</li> </ul> <p>Link: https://www.opentripplanner.org/</p>","tags":["wep001","routing","graphhopper","valhalla","gtfs","isochrones"]},{"location":"weps/wep001/#preliminary-conclusion","title":"Preliminary Conclusion","text":"<ul> <li> <p>GraphHopper is the preferred primary routing engine due to:</p> </li> <li> <p>Flexible handling of outdoor and Alpine-specific profiles</p> </li> <li>Practical integration of external data sources (Swisstopo)</li> <li>Clear distinction between build-time schema and runtime weighting</li> <li>Easier and more frequent GTFS updates compared to Valhalla</li> <li>BRouter can be optionally combined for high-quality hiking and biking time estimation.</li> <li>Valhalla remains a strong alternative if public transport routing and transit isochrones become the dominant requirement, but at the cost of reduced flexibility and higher operational complexity.</li> </ul>","tags":["wep001","routing","graphhopper","valhalla","gtfs","isochrones"]},{"location":"weps/wep001/#infrastructure-integration","title":"Infrastructure Integration","text":"","tags":["wep001","routing","graphhopper","valhalla","gtfs","isochrones"]},{"location":"weps/wep001/#docker-deployment","title":"Docker Deployment","text":"<ul> <li>Memory Target: &lt; 4 GB RAM for routing service</li> <li>Storage: PostGIS database for isochrones and results</li> <li>Updates: Automated GTFS data refresh pipeline</li> </ul>","tags":["wep001","routing","graphhopper","valhalla","gtfs","isochrones"]},{"location":"weps/wep001/#performance-targets","title":"Performance Targets","text":"<ul> <li>Single Route: &lt; 500ms response time</li> <li>Isochrone: &lt; 2s for 4h radius</li> <li>Matrix (1:100): &lt; 10s for hut accessibility analysis</li> </ul>","tags":["wep001","routing","graphhopper","valhalla","gtfs","isochrones"]},{"location":"weps/wep002/","title":"<code>WEP 2</code> Hut Access Classification","text":"<p>Transport mode categorization system for Alpine huts.</p> <p>This should give for each hut a list of how it can be accessed:</p> <ul> <li>By foot (including difficulty)</li> <li>By mountain bike</li> <li>By ski</li> <li>By car</li> <li>Public transport (time ranges: &lt;2h, &lt;4h, &lt;6h, &lt;8h), covered in WEP003</li> </ul>","tags":["WEP002","huts","accessibility","routing","classification","isochrones"]},{"location":"weps/wep002/#reachability-test-access-classification","title":"Reachability Test &amp; Access Classification","text":"<p>Goal: Categorize huts by transport accessibility for display and filtering.</p> <p>Profiles to test: foot, bike, car, ski, inaccessible.</p> <p>Workflow:</p> <ol> <li>Compute isochrone per hut for each profile.</li> <li>If isochrone is empty or does not connect to main trail/road:</li> <li>Mark as unreachable for that mode</li> <li>Classify huts based on accessible modes:</li> <li>Example:<ul> <li>\"Easy hiking\": reachable by <code>foot</code></li> <li>\"Ski winter access\": reachable by `ski``</li> <li>\"Bike\": reachable by <code>bike</code> profile</li> <li>\"Car\": reachable by <code>car</code> profile</li> <li>\"Alpine only\": no accessible mode</li> </ul> </li> <li>Store classification in DB for fast filtering and visualization.</li> </ol> <p>Optional: integrate difficulty factor for hiking or seasonal restrictions (ski season).</p>","tags":["WEP002","huts","accessibility","routing","classification","isochrones"]},{"location":"weps/wep002/#classification-examples","title":"Classification Examples","text":"","tags":["WEP002","huts","accessibility","routing","classification","isochrones"]},{"location":"weps/wep002/#swiss-alpine-huts","title":"Swiss Alpine Huts","text":"<ul> <li>H\u00f6hernm\u00e4ssli H\u00fctte: \"Alpine only\" (no road access, 4h hike)</li> <li>Berggasthaus Aescher: \"Easy hiking\" (cable car nearby, 15min walk)  </li> <li>SAC Cabane Mont Fort: \"Ski winter access\" (ski lift, 30min ski)</li> </ul>","tags":["WEP002","huts","accessibility","routing","classification","isochrones"]},{"location":"weps/wep002/#storage-in-postgis","title":"Storage in PostGIS","text":"<pre><code>CREATE TABLE hut_access_classifications (\n    hut_id UUID REFERENCES huts(id),\n    profile VARCHAR(20), -- foot, bike, car, ski\n    accessible BOOLEAN,\n    max_travel_time INTEGER, -- minutes\n    difficulty_level VARCHAR(10), -- easy, moderate, difficult\n    season VARCHAR(10), -- summer, winter, all\n    updated_at TIMESTAMP\n);\n</code></pre>","tags":["WEP002","huts","accessibility","routing","classification","isochrones"]},{"location":"weps/wep002/#implementation-notes","title":"Implementation Notes","text":"<ul> <li>Use GraphHopper isochrone feature</li> <li>Store results in PostGIS with spatial indexing</li> <li>Update classifications seasonally (ski vs hiking profiles)</li> </ul>","tags":["WEP002","huts","accessibility","routing","classification","isochrones"]},{"location":"weps/wep003/","title":"<code>WEP 3</code> Public Transport Access","text":"<p>GTFS integration and transit analysis for hut accessibility.</p>","tags":["WEP003","huts","public-transport","gtfs","accessibility","routing"]},{"location":"weps/wep003/#public-transport-close-to-huts","title":"Public Transport Close to Huts","text":"<p>Goal: Identify accessible transit stops for each hut, depending on seasonal access.</p> <p>Workflow:</p> <ol> <li>Candidate selection: find all PT stops within a radius (e.g., 30 km) of the hut.</li> <li>One-to-many matrix routing: compute shortest paths from hut to each candidate stop using GraphHopper profiles (foot in summer, ski in winter).</li> <li>Filter unreachable stops: remove stops that exceed maximum travel time (e.g., 5h) or dead-end edges.</li> <li>Store results in DB:</li> <li><code>hut_id | stop_id | profile | travel_time | distance</code></li> <li>User query: when a user requests huts reachable by transit, check intersection between precomputed hut-accessible stops and user isochrone + GTFS availability.</li> </ol> <p>Advantages:</p> <ul> <li>Reduces matrix calculations compared to full hut \u2192 all stops.</li> <li>Efficient even for hundreds of huts.</li> <li>Supports seasonal profiles.</li> </ul>","tags":["WEP003","huts","public-transport","gtfs","accessibility","routing"]},{"location":"weps/wep003/#implementation-notes","title":"Implementation Notes","text":"<ul> <li>Use GraphHopper one-to-many matrix API for hut \u2192 PT stop computations</li> <li>Use PostGIS spatial functions for intersection (ST_Intersects, ST_DWithin)</li> </ul>","tags":["WEP003","huts","public-transport","gtfs","accessibility","routing"]},{"location":"weps/wep004-external-source-routing/","title":"<code>WEP 4</code> Routing on External Data Sources","text":"<p>Swisstopo data integration for hiking and ski touring routes.</p>","tags":["WEP004","routing","swisstopo","osm","hiking","ski-touring","data-integration"]},{"location":"weps/wep004-external-source-routing/#swisstopo","title":"Swisstopo","text":"<p>This document describes a practical, reproducible workflow to convert SwissTopo hiking trail data (GPKG) into OSM-compatible data and use it with Valhalla for hiking routing. It also lays the foundation for later improvements such as source preference and ski touring routing.</p>","tags":["WEP004","routing","swisstopo","osm","hiking","ski-touring","data-integration"]},{"location":"weps/wep004-external-source-routing/#data-source-swisstlm3d","title":"Data Source: swissTLM3D","text":"<p>The dataset is derived from swissTLM3D (Topographic Landscape Model of Switzerland).</p>","tags":["WEP004","routing","swisstopo","osm","hiking","ski-touring","data-integration"]},{"location":"weps/wep004-external-source-routing/#official-documentation","title":"Official Documentation","text":"<p>The Datensatzkatalog swissTLM3D (PDF) defines:</p> <ul> <li>Feature classes</li> <li>Attribute names</li> <li>Value domains (coded values)</li> <li>Semantics of fields such as <code>wanderwege</code>, <code>befahrbarkeit</code>, <code>belagsart</code>, etc.</li> </ul>","tags":["WEP004","routing","swisstopo","osm","hiking","ski-touring","data-integration"]},{"location":"weps/wep004-external-source-routing/#relevant-fields","title":"Relevant fields","text":"<p>From your GPKG, the following fields are important for routing (from <code>TLM_STRASSEN</code>):</p> <ul> <li><code>objektart</code> \u2013 Way / road type including implied width, expressed as a named class (e.g. \"1 m Weg\", \"2 m Weg\", \"Markierte Spur\", \"Klettersteig\")</li> <li><code>wanderwege</code> \u2013 hiking route classification (Wanderweg, Bergwanderweg, Alpinwanderweg)</li> <li><code>stufe</code> \u2013 NOT hiking difficulty (vertical / technical level at crossings)</li> <li><code>befahrbarkeit</code> \u2013 passability / access</li> <li><code>belagsart</code> \u2013 surface type</li> <li><code>richtungsgetrennt</code> \u2013 direction-separated geometry</li> <li><code>name</code> \u2013 trail name</li> </ul> <p>All remaining fields are administrative metadata and are ignored for routing.</p>","tags":["WEP004","routing","swisstopo","osm","hiking","ski-touring","data-integration"]},{"location":"weps/wep004-external-source-routing/#target-osm-tagging-model","title":"Target OSM Tagging Model","text":"<p>Reference: OSM Hiking Wiki</p>","tags":["WEP004","routing","swisstopo","osm","hiking","ski-touring","data-integration"]},{"location":"weps/wep004-external-source-routing/#base-tags-always-applied","title":"Base tags (always applied)","text":"<pre><code>highway=path\nfoot=yes\nsource=swisstopo\n</code></pre>","tags":["WEP004","routing","swisstopo","osm","hiking","ski-touring","data-integration"]},{"location":"weps/wep004-external-source-routing/#hiking-difficulty","title":"Hiking difficulty","text":"<p>SwissTopo does not encode hiking difficulty in <code>stufe</code>.</p> <p>Difficulty is derived from named classifications:</p> <ul> <li><code>wanderwege</code> (primary)</li> <li><code>objektart</code> (secondary, e.g. Klettersteig)</li> </ul> <p>These are mapped to <code>sac_scale</code>, which Valhalla understands natively:</p> Swiss classification OSM tag Wanderweg sac_scale=hiking Bergwanderweg sac_scale=mountain_hiking Alpinwanderweg sac_scale=alpine_hiking","tags":["WEP004","routing","swisstopo","osm","hiking","ski-touring","data-integration"]},{"location":"weps/wep004-external-source-routing/#access-passability","title":"Access / passability","text":"<pre><code>access=yes | no | permissive\n</code></pre>","tags":["WEP004","routing","swisstopo","osm","hiking","ski-touring","data-integration"]},{"location":"weps/wep004-external-source-routing/#surface","title":"Surface","text":"<pre><code>surface=paved | gravel | ground | rock\n</code></pre>","tags":["WEP004","routing","swisstopo","osm","hiking","ski-touring","data-integration"]},{"location":"weps/wep004-external-source-routing/#direction-only-if-applicable","title":"Direction (only if applicable)","text":"<pre><code>oneway=yes\n</code></pre>","tags":["WEP004","routing","swisstopo","osm","hiking","ski-touring","data-integration"]},{"location":"weps/wep004-external-source-routing/#name","title":"Name","text":"<pre><code>name=&lt;trail name&gt;\n</code></pre>","tags":["WEP004","routing","swisstopo","osm","hiking","ski-touring","data-integration"]},{"location":"weps/wep004-external-source-routing/#toolchain","title":"Toolchain","text":"","tags":["WEP004","routing","swisstopo","osm","hiking","ski-touring","data-integration"]},{"location":"weps/wep004-external-source-routing/#required-tools","title":"Required tools","text":"<pre><code>pip install ogr2osm\nsudo apt install gdal-bin osmium-tool\n</code></pre>","tags":["WEP004","routing","swisstopo","osm","hiking","ski-touring","data-integration"]},{"location":"weps/wep004-external-source-routing/#processing-flow","title":"Processing flow","text":"<pre><code>GPKG (swisstopo)\n  \u2193 ogr2osm + translation script\nOSM XML\n  \u2193 osmium\nOSM PBF\n  \u2193 Routing service build\nRouting\n</code></pre>","tags":["WEP004","routing","swisstopo","osm","hiking","ski-touring","data-integration"]},{"location":"weps/wep004-external-source-routing/#example-ogr2osm-translation-script","title":"Example ogr2osm Translation Script","text":"<p>Save as <code>swisstopo_wanderwege.py</code></p> <p>Important notes:</p> <ul> <li><code>objektart</code> defines way type and width</li> <li><code>stufe</code> is NOT used for hiking difficulty</li> </ul> <p>This script generates clean OSM tags, maps hiking difficulty, handles access and surface, and produces routing-compatible data:</p> <pre><code>def filter_tags(attrs):\n    tags = {}\n\n    # Base tags\n    tags[\"highway\"] = \"path\"\n    tags[\"foot\"] = \"yes\"\n    tags[\"source\"] = \"swisstopo\"\n\n    # Name\n    if attrs.get(\"name\"):\n        tags[\"name\"] = attrs[\"name\"]\n\n    # Objektart \u2192 way type / width (use names, not IDs)\n    objektart = str(attrs.get(\"objektart\", \"\")).lower()\n\n    if \"1 m weg\" in objektart:\n        tags.update({\"highway\": \"path\", \"width\": \"1\"})\n    elif \"2 m weg\" in objektart:\n        tags.update({\"highway\": \"path\", \"width\": \"2\"})\n    elif \"markierte spur\" in objektart:\n        tags.update({\"highway\": \"path\", \"trail_visibility\": \"good\"})\n    elif \"klettersteig\" in objektart:\n        tags.update({\n            \"highway\": \"via_ferrata\",\n            \"sac_scale\": \"demanding_alpine_hiking\"\n        })\n    elif \"fahrstrasse\" in objektart or \"strasse\" in objektart:\n        tags.update({\"highway\": \"track\"})\n\n    # Wanderwege \u2192 sac_scale (authoritative)\n    wanderwege = str(attrs.get(\"wanderwege\", \"\")).lower()\n\n    if \"wanderweg\" in wanderwege:\n        tags[\"sac_scale\"] = \"hiking\"\n    elif \"bergwanderweg\" in wanderwege:\n        tags[\"sac_scale\"] = \"mountain_hiking\"\n    elif \"alpinwanderweg\" in wanderwege:\n        tags[\"sac_scale\"] = \"alpine_hiking\"\n\n    # Access / passability\n    befahrbarkeit = str(attrs.get(\"befahrbarkeit\", \"\")).lower()\n    if befahrbarkeit in (\"wahr\", \"true\", \"ja\"):\n        tags[\"access\"] = \"yes\"\n    elif befahrbarkeit in (\"falsch\", \"false\", \"nein\"):\n        tags[\"access\"] = \"no\"\n    else:\n        tags[\"access\"] = \"permissive\"\n\n    # Surface\n    belag = str(attrs.get(\"belagsart\", \"\")).lower()\n    if \"asphalt\" in belag or \"beton\" in belag:\n        tags[\"surface\"] = \"paved\"\n    elif \"kies\" in belag or \"schotter\" in belag:\n        tags[\"surface\"] = \"gravel\"\n    elif \"fels\" in belag or \"felsen\" in belag:\n        tags[\"surface\"] = \"rock\"\n    else:\n        tags[\"surface\"] = \"ground\"\n\n    # Direction separation\n    if str(attrs.get(\"richtungsgetrennt\", \"\")).lower() in (\"ja\", \"true\", \"1\"):\n        tags[\"oneway\"] = \"yes\"\n\n    return tags\n</code></pre>","tags":["WEP004","routing","swisstopo","osm","hiking","ski-touring","data-integration"]},{"location":"weps/wep004-external-source-routing/#run-the-conversion","title":"Run the conversion","text":"<pre><code>ogr2osm wanderwege.gpkg \\\n  -t swisstopo_wanderwege.py \\\n  -o wanderwege.osm\n</code></pre> <p>Convert to PBF:</p> <pre><code>osmium cat wanderwege.osm -o wanderwege.pbf\n</code></pre>","tags":["WEP004","routing","swisstopo","osm","hiking","ski-touring","data-integration"]},{"location":"weps/wep004-external-source-routing/#data-sources-access","title":"Data Sources &amp; Access","text":"","tags":["WEP004","routing","swisstopo","osm","hiking","ski-touring","data-integration"]},{"location":"weps/wep004-external-source-routing/#swisstopo-data-portal","title":"Swisstopo Data Portal","text":"<ul> <li>swissTLM3D: Authoritative topographic landscape model</li> <li>Download: swisstopo geoportal</li> <li>License: Free for non-commercial use, requires registration</li> </ul>","tags":["WEP004","routing","swisstopo","osm","hiking","ski-touring","data-integration"]},{"location":"weps/wep004-external-source-routing/#gtfs-for-switzerland","title":"GTFS for Switzerland","text":"<ul> <li>SBB/CFF/FFS: opentransportdata.swiss</li> <li>Regional providers: Various cantonal transport operators</li> <li>Update frequency: Daily for major operators</li> </ul>","tags":["WEP004","routing","swisstopo","osm","hiking","ski-touring","data-integration"]},{"location":"weps/wep004-external-source-routing/#next-steps","title":"Next Steps","text":"<ul> <li>Create GraphHopper and BRouter custom profiles</li> <li>Add trail running bias for running-specific routing</li> <li>Implement ski touring routing with winter-specific data</li> <li>Integrate seasonal data updates (summer/winter trail networks)</li> </ul>","tags":["WEP004","routing","swisstopo","osm","hiking","ski-touring","data-integration"]},{"location":"weps/wep005/","title":"<code>WEP 5</code> Hut Access Isochrones","text":"<p>Spatial computation and storage of accessibility isochrones in PostGIS.</p>","tags":["WEP005","huts","isochrones","postgis","routing","accessibility"]},{"location":"weps/wep005/#computation-workflow","title":"Computation Workflow","text":"<ol> <li>Batch Processing: Generate isochrones for all huts</li> <li>Profile Combinations: foot, bike, ski, car</li> <li>Time Intervals: 30min, 1h, 2h, 4h, ...</li> <li>Seasonal Updates: Winter (ski) vs Summer (hiking/bike)</li> <li>PostGIS Storage: Polygons with spatial indexing</li> </ol>","tags":["WEP005","huts","isochrones","postgis","routing","accessibility"]},{"location":"weps/wep005/#use-cases","title":"Use Cases","text":"<ul> <li>Hut Search: Find huts within X minutes of user location</li> <li>Accessibility Analysis: Visualize reachable areas from each hut</li> <li>Route Planning: Multi-modal journey planning</li> <li>Statistics: Hut network coverage and accessibility metrics</li> </ul>","tags":["WEP005","huts","isochrones","postgis","routing","accessibility"]},{"location":"weps/wep005/#performance-considerations","title":"Performance Considerations","text":"<ul> <li>Spatial Indexing: Use GIST indexes for fast polygon queries</li> <li>Precomputation: Batch updates during off-peak hours</li> <li>Caching: Cache frequent queries (popular huts, time ranges)</li> </ul>","tags":["WEP005","huts","isochrones","postgis","routing","accessibility"]},{"location":"weps/wep005/#data-model","title":"Data Model","text":"","tags":["WEP005","huts","isochrones","postgis","routing","accessibility"]},{"location":"weps/wep005/#postgis-storage","title":"PostGIS Storage","text":"<pre><code>CREATE TABLE hut_isochrones (\n    id UUID PRIMARY KEY,\n    hut_id UUID REFERENCES huts(id),\n    profile VARCHAR(20), -- foot, bike, car, ski\n    max_time INTEGER, -- minutes (30, 60, 120, 240)\n    geometry GEOMETRY(POLYGON, 4326),\n    created_at TIMESTAMP,\n    season VARCHAR(10) -- summer, winter, all\n);\n\nCREATE INDEX idx_hut_isochrones_hut_profile ON hut_isochrones(hut_id, profile, max_time);\nCREATE INDEX idx_hut_isochrones_geom ON hut_isochrones USING GIST(geometry);\n</code></pre>","tags":["WEP005","huts","isochrones","postgis","routing","accessibility"]},{"location":"weps/wep006/","title":"<code>WEP 6</code> ParadeDB Integration for Advanced Search","text":"<p>Integrating ParadeDB to provide Elasticsearch-quality full-text search with BM25 ranking while maintaining native PostGIS integration for geographic queries.</p>","tags":["wep006","search","postgresql"]},{"location":"weps/wep006/#requirements","title":"Requirements","text":"<ul> <li>Improved search relevance using BM25 ranking algorithm (Elasticsearch-quality)</li> <li>Multi-language fuzzy search across all translations with better performance</li> <li>Native PostGIS integration for combined text + geographic queries in single SQL</li> <li>Zero synchronization overhead - search directly on operational data</li> <li>Minimal infrastructure changes - prefer extension over additional services</li> <li>Backward compatibility - maintain existing API contracts</li> </ul>","tags":["wep006","search","postgresql"]},{"location":"weps/wep006/#current-state-analysis","title":"Current State Analysis","text":"","tags":["wep006","search","postgresql"]},{"location":"weps/wep006/#existing-search-implementation","title":"Existing Search Implementation","text":"<p>Current Approach: * Trigram similarity via <code>pg_trgm</code> for fuzzy matching * Multi-language support using JSONB <code>i18n</code> field * Complex scoring combining similarity, importance, prefix match, token match, and FTS rank * Deduplication using PostGIS for near-identical places * Separate endpoint for nearby queries</p> <p>Performance Characteristics: * Trigram search performance degrades with dataset size * Multiple similarity calculations across all languages * ~75+ lines of complex annotation logic * Multiple GIN indexes required (full-text + trigrams)</p> <p>Strengths: * Good multi-language fuzzy matching * Sophisticated composite ranking * Smart deduplication logic * Clean Django ORM integration</p> <p>Weaknesses: * Complex query logic (hard to maintain) * Performance degrades with large datasets * No true BM25 ranking (only <code>ts_rank</code>) * Index sprawl (multiple GIN indexes) * Manual similarity score calculation</p>","tags":["wep006","search","postgresql"]},{"location":"weps/wep006/#proposed-solution","title":"Proposed Solution","text":"","tags":["wep006","search","postgresql"]},{"location":"weps/wep006/#paradedb-overview","title":"ParadeDB Overview","text":"<p>ParadeDB is a PostgreSQL extension built on Tantivy (Rust search library) that provides:</p> <ul> <li>BM25 full-text search (same algorithm as Elasticsearch)</li> <li>164x faster fuzzy search than <code>pg_trgm</code> in benchmarks</li> <li>Zero ETL - search directly on PostgreSQL data</li> <li>ACID compliant - maintains transactional consistency</li> </ul> <p>Key Features: * BM25 ranking with global corpus statistics * Fuzzy search via Levenshtein distance (edit distance) * Phrase matching, boolean queries, prefix matching * Field-specific search with boosting * JSONB field indexing (perfect for our <code>i18n</code> structure) * Hybrid search support (BM25 + semantic vectors)</p>","tags":["wep006","search","postgresql"]},{"location":"weps/wep006/#why-paradedb-over-alternatives","title":"Why ParadeDB Over Alternatives","text":"Solution BM25 PostGIS Integration Multi-Language Infrastructure Effort ParadeDB \u2705 Yes \u2705 Native \u2705 JSONB support Extension only 6-12h Meilisearch \u2705 Yes \u274c Separate \u26a0\ufe0f Multiple indexes New service 24-48h Elasticsearch \u2705 Yes \u274c Separate \u26a0\ufe0f Complex New cluster 40-80h Optimize PG \u274c ts_rank only \u2705 Native \u26a0\ufe0f Manual No changes 8-16h <p>ParadeDB Wins For: * Native PostGIS integration (single query combining text + geo) * Works with our existing JSONB structure * No additional services or synchronization * Fastest implementation time * True BM25 ranking quality</p>","tags":["wep006","search","postgresql"]},{"location":"weps/wep006/#technical-architecture","title":"Technical Architecture","text":"","tags":["wep006","search","postgresql"]},{"location":"weps/wep006/#docker-deployment-strategy","title":"Docker Deployment Strategy","text":"<p>Two options available, each with trade-offs:</p>","tags":["wep006","search","postgresql"]},{"location":"weps/wep006/#option-a-paradedb-docker-image-recommended","title":"Option A: ParadeDB Docker Image (Recommended) \u2705","text":"<p>Use <code>paradedb/paradedb:pg16-postgis-3.4-alpine</code> image</p> <p>Advantages: * Pre-built extension (already compiled and tested) * PostGIS 3.4 included * Zero compilation or build dependencies * Official support from ParadeDB team * Simple upgrade path (change image tag)</p> <p>Disadvantages: * Different base image than current <code>postgis/postgis</code> * Slightly larger image size * Requires data migration to new container</p> <p>Migration Process: 1. Backup existing data with <code>pg_dump</code> 2. Switch to ParadeDB image 3. Restore with <code>psql</code> 4. Verify extension installation</p> <p>Migration Effort: ~30 minutes for data migration + testing</p>","tags":["wep006","search","postgresql"]},{"location":"weps/wep006/#option-b-manual-extension-installation","title":"Option B: Manual Extension Installation","text":"<p>Install <code>pg_search</code> extension in existing <code>postgis/postgis:16-3.4-alpine</code> image</p> <p>Advantages: * Keep current image (no container migration) * Familiar base image * No data migration</p> <p>Disadvantages: * Compilation required (Rust toolchain in container) * Complex build process * Compatibility risk (extension version must match PostgreSQL minor version) * Maintenance burden (manual rebuilds for updates) * No official support</p> <p>Why Not Recommended: * ParadeDB compilation is complex and error-prone * Alpine compatibility issues with Rust * ~30-60 minutes additional build time * Harder to reproduce across environments</p>","tags":["wep006","search","postgresql"]},{"location":"weps/wep006/#recommendation-option-a-paradedb-docker-image","title":"Recommendation: Option A (ParadeDB Docker Image) \u2705","text":"<p>Rationale: * Official ParadeDB images are well-tested and optimized * Includes PostGIS 3.4 (same version we use) * Simple 5-minute change vs complex compilation * ParadeDB team maintains compatibility * Data migration is straightforward</p>","tags":["wep006","search","postgresql"]},{"location":"weps/wep006/#django-integration","title":"Django Integration","text":"<p>Package: <code>paradedb-django</code> (v1.2.0 on PyPI)</p>","tags":["wep006","search","postgresql"]},{"location":"weps/wep006/#model-configuration","title":"Model Configuration","text":"<p>Add BM25 index to existing model:</p> <pre><code># Add BM25Index to model's Meta\nBm25Index(\n    fields=[\"id\", \"name\", \"i18n\", \"importance\", \"country_code\"],\n    json_fields=[\n        JSONFieldIndexConfig(\"i18n\", fast=True)\n    ]\n)\n</code></pre>","tags":["wep006","search","postgresql"]},{"location":"weps/wep006/#api-query-updates","title":"API Query Updates","text":"<p>Before (complex, 75+ lines): <pre><code># Multiple TrigramSimilarity calculations\n# Complex score annotations\n# Manual similarity thresholds\n</code></pre></p> <p>After (simplified): <pre><code># Search across requested language\nqueryset.filter(\n    JsonOp(\"i18n\", \"name_{lang}\", \"match\", value=query) |\n    Search(\"name\", query)\n)\n</code></pre></p>","tags":["wep006","search","postgresql"]},{"location":"weps/wep006/#multi-language-search-with-jsonb","title":"Multi-Language Search with JSONB","text":"<p>How It Works: * ParadeDB automatically indexes all JSONB keys * Our <code>i18n</code> field stores translations like: <code>{\"name_en\": \"Matterhorn\", \"name_de\": \"Matterhorn\", \"name_fr\": \"Cervin\"}</code> * Fast field configuration enables efficient JSONB queries</p> <p>Search Patterns:</p> <pre><code># Single language search\nfilter(JsonOp(\"i18n\", \"name_de\", \"match\", value=\"Matterhorn\"))\n\n# Multi-language fallback\nfilter(\n    JsonOp(\"i18n\", \"name_de\", \"match\", value=query) |\n    JsonOp(\"i18n\", \"name_fr\", \"match\", value=query) |\n    Search(\"name\", query)\n)\n</code></pre>","tags":["wep006","search","postgresql"]},{"location":"weps/wep006/#postgis-integration","title":"PostGIS Integration","text":"<p>Key Advantage: ParadeDB works seamlessly with PostGIS in a single query</p> <pre><code># Combined: BM25 text search + geographic distance + importance\nfilter(\n    Search(\"name\", query),\n    location__distance_lte=(point, D(km=10))\n).annotate(\n    distance=Distance(\"location\", point)\n).order_by(\"distance\", \"-importance\")\n</code></pre>","tags":["wep006","search","postgresql"]},{"location":"weps/wep006/#implementation-plan","title":"Implementation Plan","text":"","tags":["wep006","search","postgresql"]},{"location":"weps/wep006/#phase-1-setup-2-hours","title":"Phase 1: Setup (2 hours)","text":"<p>Tasks: 1. Update docker-compose.yml with ParadeDB image 2. Backup existing PostgreSQL data 3. Start ParadeDB container 4. Verify extension installation 5. Install <code>paradedb-django</code> package</p>","tags":["wep006","search","postgresql"]},{"location":"weps/wep006/#phase-2-integration-4-6-hours","title":"Phase 2: Integration (4-6 hours)","text":"<p>Tasks: 1. Add BM25Index to GeoPlace model 2. Create migration 3. Update search endpoint 4. Update nearby endpoint (if needed) 5. Add helper functions for multi-language search</p>","tags":["wep006","search","postgresql"]},{"location":"weps/wep006/#phase-3-testing-4-hours","title":"Phase 3: Testing (4 hours)","text":"<p>Unit Tests: * Basic search functionality * Multi-language search * Fuzzy matching * Combined PostGIS queries * Edge cases (empty queries, special characters)</p> <p>Integration Tests: * Verify all existing endpoints return same results * Check response format unchanged * Validate filtering (type, category, country, importance) * Test pagination</p> <p>Performance Tests: * Benchmark current vs ParadeDB * Measure query latency * Check index usage</p>","tags":["wep006","search","postgresql"]},{"location":"weps/wep006/#phase-4-deployment-2-hours","title":"Phase 4: Deployment (2 hours)","text":"<p>Staging: 1. Deploy to staging environment 2. Run full test suite 3. Load test with production-like data 4. Monitor query performance 5. Compare with current implementation</p> <p>Production: 1. Schedule maintenance window 2. Backup production database 3. Deploy ParadeDB container 4. Run migrations 5. Verify API responses 6. Monitor error rates and performance</p>","tags":["wep006","search","postgresql"]},{"location":"weps/wep006/#performance-comparison","title":"Performance Comparison","text":"","tags":["wep006","search","postgresql"]},{"location":"weps/wep006/#expected-improvements","title":"Expected Improvements","text":"Metric Current (Trigram) ParadeDB (BM25) Improvement Fuzzy search ~500-1000ms ~100-200ms 5x faster Full-text search ~200-400ms ~50-100ms 4x faster Multi-language Multiple queries Single query Simpler Code complexity 75+ lines ~20 lines 4x simpler Index count 3-5 GIN indexes 1 BM25 index Simpler","tags":["wep006","search","postgresql"]},{"location":"weps/wep006/#benchmark-data-source","title":"Benchmark Data Source","text":"<p>Based on ParadeDB official benchmarks (2024): * Fuzzy search: 164x faster than <code>pg_trgm</code> (22.8s \u2192 139ms) * Full-text search: 4.4x faster than native PostgreSQL (401ms \u2192 92ms) * Field-specific search: 48x faster (4.4s \u2192 90ms)</p> <p>Our Use Case: * Moderate dataset (~100K places) * Multi-language queries * PostGIS integration * Expected: 3-5x overall improvement</p>","tags":["wep006","search","postgresql"]},{"location":"weps/wep006/#rollback-strategy","title":"Rollback Strategy","text":"","tags":["wep006","search","postgresql"]},{"location":"weps/wep006/#if-issues-arise","title":"If Issues Arise","text":"<p>Immediate Rollback (&lt; 5 minutes): <pre><code># Stop ParadeDB\ndocker-compose down\n\n# Revert docker-compose.yml\ngit checkout HEAD -- docker-compose.yml\n\n# Restart PostGIS\ndocker-compose up -d db\n\n# Restore from backup if needed\n</code></pre></p> <p>Code Rollback: * Remove migrations * Remove package * Revert API and model changes</p>","tags":["wep006","search","postgresql"]},{"location":"weps/wep006/#data-safety","title":"Data Safety","text":"<ul> <li>No data migration required (BM25 index is separate)</li> <li>Original data untouched</li> <li>Trigram indexes remain intact</li> <li>Can run both implementations in parallel for testing</li> </ul>","tags":["wep006","search","postgresql"]},{"location":"weps/wep006/#migration-timeline","title":"Migration Timeline","text":"","tags":["wep006","search","postgresql"]},{"location":"weps/wep006/#total-effort-12-16-hours","title":"Total Effort: 12-16 hours","text":"Phase Duration Dependencies Phase 1: Setup 2 hours None Phase 2: Integration 4-6 hours Phase 1 complete Phase 3: Testing 4 hours Phase 2 complete Phase 4: Deployment 2 hours Phase 3 complete","tags":["wep006","search","postgresql"]},{"location":"weps/wep006/#milestones","title":"Milestones","text":"<ol> <li>Milestone 1: ParadeDB running with extension verified (Day 1, 2h)</li> <li>Milestone 2: BM25 index created (Day 1, 6h)</li> <li>Milestone 3: Search endpoint updated (Day 2, 10h)</li> <li>Milestone 4: Tests passing (Day 2, 14h)</li> <li>Milestone 5: Deployed to staging (Day 3, 16h)</li> </ol>","tags":["wep006","search","postgresql"]},{"location":"weps/wep006/#risks-and-mitigations","title":"Risks and Mitigations","text":"Risk Impact Probability Mitigation Data migration issues High Low Test backup/restore in staging first Extension compatibility Medium Low Use official ParadeDB image (tested) Performance regression High Low Benchmark in staging before production API incompatibility Medium Low Comprehensive integration tests Learning curve Low Medium Team training on ParadeDB syntax","tags":["wep006","search","postgresql"]},{"location":"weps/wep006/#success-criteria","title":"Success Criteria","text":"","tags":["wep006","search","postgresql"]},{"location":"weps/wep006/#functional-requirements","title":"Functional Requirements","text":"<ul> <li>All existing search functionality works</li> <li>Multi-language search operational</li> <li>PostGIS integration maintained</li> <li>API responses unchanged</li> <li>Backward compatible with existing clients</li> </ul>","tags":["wep006","search","postgresql"]},{"location":"weps/wep006/#performance-requirements","title":"Performance Requirements","text":"<ul> <li>95<sup>th</sup> percentile query latency &lt; 200ms</li> <li>Index-only scans for common queries</li> <li>No increase in database CPU usage</li> <li>Index size &lt; 20% of data size</li> </ul>","tags":["wep006","search","postgresql"]},{"location":"weps/wep006/#quality-requirements","title":"Quality Requirements","text":"<ul> <li>All tests passing</li> <li>No regressions in search relevance</li> <li>Clean code review approval</li> <li>Documentation updated</li> </ul>","tags":["wep006","search","postgresql"]},{"location":"weps/wep006/#future-considerations","title":"Future Considerations","text":"","tags":["wep006","search","postgresql"]},{"location":"weps/wep006/#phase-2-enhancements-optional","title":"Phase 2 Enhancements (Optional)","text":"<ul> <li>Semantic Search: Integrate <code>pgvector</code> for vector embeddings</li> <li>Hybrid Search: Combine BM25 + semantic with RRF (Reciprocal Rank Fusion)</li> <li>Autocomplete: Implement suggestive search with prefix queries</li> <li>Search Analytics: Track query patterns for optimization</li> <li>Synonyms: Add synonym support for common place name variants</li> </ul>","tags":["wep006","search","postgresql"]},{"location":"weps/wep006/#scalability","title":"Scalability","text":"<ul> <li>Vertical scaling: ParadeDB scales to millions of documents</li> <li>Read replicas: Can use read replicas for search-heavy workloads</li> <li>Caching: Add Redis for frequent search queries</li> <li>Materialized views: Pre-compute common search patterns</li> </ul>","tags":["wep006","search","postgresql"]},{"location":"weps/wep006/#conclusion","title":"Conclusion","text":"<p>ParadeDB provides a compelling upgrade to our current search implementation:</p> <ul> <li>Better relevance through true BM25 ranking</li> <li>Faster queries with 3-5x performance improvement</li> <li>Simpler code reducing complexity by 4x</li> <li>Native PostGIS integration maintaining our geo capabilities</li> <li>Zero synchronization overhead with direct data access</li> <li>Low implementation effort (12-16 hours vs 40-80h for Elasticsearch)</li> </ul> <p>The recommended approach uses the official ParadeDB Docker image, which includes PostGIS and requires only a straightforward data migration. This minimizes risk while providing significant improvements to search quality and performance.</p> <p>Recommendation: Proceed with Phase 1 (Setup) as proof-of-concept, with full rollout upon successful testing.</p>","tags":["wep006","search","postgresql"]},{"location":"weps/wep007/","title":"<code>WEP 7</code> Weather Forecast","text":"<p>Weather forecast integration for huts and mountain locations.</p>","tags":["wep007","weather"]},{"location":"weps/wep007/#overview","title":"Overview","text":"<p>Basic Concept:</p> <ul> <li>Display 14-day weather forecast per hut</li> <li>Frontend-driven display (direct API calls from client)</li> <li>Store daily weather data in DB (similar to availability data)</li> <li>Enable weather-based hut search: \"Show huts with good weather this weekend\" or \"Huts with temperature &gt; 20\u00b0C\"</li> <li>Group nearby hut locations to reduce API calls</li> <li>Daily updates via background job</li> </ul>","tags":["wep007","weather"]},{"location":"weps/wep007/#use-cases","title":"Use Cases","text":"<p>Phase 1: Display (Frontend-only)</p> <ul> <li>Show 14-day forecast on hut detail pages</li> <li>Link to detailed national weather service based on country</li> </ul> <p>Phase 2: Search &amp; Filtering (Backend storage)</p> <ul> <li>\"Show me all huts with good weather this weekend\"</li> <li>\"Find huts with temperature over 20\u00b0C on Saturday\"</li> <li>\"Huts with less than 20% precipitation probability\"</li> <li>Filter by snow conditions, wind speed, etc.</li> </ul>","tags":["wep007","weather"]},{"location":"weps/wep007/#weather-data-apis","title":"Weather Data APIs","text":"","tags":["wep007","weather"]},{"location":"weps/wep007/#open-meteo","title":"Open-Meteo","text":"<p>Free, open-source weather API aggregating multiple national weather services.</p> <ul> <li>License: Free for non-commercial use (no API key required)</li> <li>Rate Limits: 10,000 requests/day</li> <li>Resolution: 1-11 km depending on region</li> <li>Forecast: Up to 16 days</li> <li>Alpine Features: Elevation-adjusted, snow depth, freezing level, high-altitude wind</li> <li>Data Sources: NOAA, DWD, Meteo-France, ECMWF, GFS, ICON</li> <li>CORS: Enabled (direct frontend access possible)</li> </ul> <p>Link: https://open-meteo.com/</p> <p>API Endpoint: <code>https://api.open-meteo.com/v1/forecast</code></p>","tags":["wep007","weather"]},{"location":"weps/wep007/#openweathermap","title":"OpenWeatherMap","text":"<p>Popular commercial weather API with free tier.</p> <ul> <li>License: Free tier available</li> <li>Rate Limits: 60 calls/minute, 1,000,000 calls/month (free tier)</li> <li>Forecast: 5 days / 3-hour intervals (free), 16 days (paid)</li> <li>Features: Current weather, air pollution API, weather maps</li> <li>API Key: Required</li> </ul> <p>Link: https://openweathermap.org/</p> <p>API Endpoint: <code>https://api.openweathermap.org/data/2.5/forecast</code></p>","tags":["wep007","weather"]},{"location":"weps/wep007/#meteoswiss-switzerland","title":"MeteoSwiss (Switzerland)","text":"<p>Official Swiss weather service with open data.</p> <ul> <li>License: Free, open government data</li> <li>Coverage: Switzerland only</li> <li>Forecast: Local forecasts for Swiss locations</li> <li>Quality: High accuracy for Alpine regions</li> <li>API: JSON REST API</li> </ul> <p>Links:</p> <ul> <li>API Documentation: https://opendatadocs.meteoswiss.ch/e-forecast-data/e4-local-forecast-data</li> <li>Weather Symbols: https://www.meteoswiss.admin.ch/weather/weather-and-climate-from-a-to-z/weather-symbols.html</li> </ul>","tags":["wep007","weather"]},{"location":"weps/wep007/#weather-icons-code-mappings","title":"Weather Icons &amp; Code Mappings","text":"","tags":["wep007","weather"]},{"location":"weps/wep007/#basmilius-weather-icons","title":"Basmilius Weather Icons","text":"<p>Animated SVG weather icons with modern design.</p> <ul> <li>License: MIT (free for commercial use)</li> <li>Variants: Animated, static, day/night, fill/outline</li> <li>Quality: High-quality, professional design</li> </ul> <p>Link: https://github.com/basmilius/weather-icons WMO Conversion: https://github.com/thielj/weather-icons</p>","tags":["wep007","weather"]},{"location":"weps/wep007/#omweather-icons","title":"OMWeather Icons","text":"<p>Simple, open-source weather icons with WMO code mapping.</p> <ul> <li>License: Open source</li> <li>WMO Codes: Visual reference for all WMO weather codes</li> <li>Coverage: Complete WMO 4677 standard</li> </ul> <p>Links:</p> <ul> <li>Repository: https://github.com/woheller69/omweather/tree/master</li> <li>WMO Code Reference Image: https://github.com/woheller69/omweather/blob/master/wmo_codes.png</li> </ul>","tags":["wep007","weather"]},{"location":"weps/wep007/#wmo-to-openweathermap-mapping","title":"WMO to OpenWeatherMap Mapping","text":"<p>Code conversion between WMO 4677 and OpenWeatherMap codes.</p> <p>Link: https://gist.github.com/stellasphere/9490c195ed2b53c707087c8c2db4ec0c</p>","tags":["wep007","weather"]},{"location":"weps/wep007/#meteoswiss-icons","title":"MeteoSwiss Icons","text":"<p>Official Swiss weather service icons.</p> <ul> <li>License: Unknown (check MeteoSwiss terms)</li> <li>Coverage: Swiss-specific weather symbols</li> <li>Format: SVG</li> </ul> <p>Link: https://www.meteoswiss.admin.ch/weather/weather-and-climate-from-a-to-z/weather-symbols.html Link: https://docs.discover.swiss/dev/reference/weather-icons/ URL: <code>https://www.meteoswiss.admin.ch/static/resources/weather-symbols/{id}.svg</code></p>","tags":["wep007","weather"]},{"location":"weps/wep007/#country-specific-weather-services","title":"Country-Specific Weather Services","text":"","tags":["wep007","weather"]},{"location":"weps/wep007/#strategy","title":"Strategy","text":"<p>Display broad overview in-app with link to detailed national weather service:</p> <ul> <li>Switzerland: Link to MeteoSwiss</li> <li>Austria: Link to ZAMG (Zentralanstalt f\u00fcr Meteorologie und Geodynamik)</li> <li>France: Link to M\u00e9t\u00e9o-France</li> <li>Italy: Link to Meteo.it</li> <li>Germany: Link to DWD (Deutscher Wetterdienst)</li> <li>Other: Link to MeteoBlue or Open-Meteo</li> </ul>","tags":["wep007","weather"]},{"location":"weps/wep007/#national-weather-service-links","title":"National Weather Service Links","text":"Country Service URL Switzerland MeteoSwiss <code>https://www.meteoswiss.admin.ch/</code> Austria ZAMG <code>https://www.zamg.ac.at/</code> France M\u00e9t\u00e9o-France <code>https://meteofrance.com/</code> Italy Meteo.it <code>https://www.meteo.it/</code> Germany DWD <code>https://www.dwd.de/</code> Generic MeteoBlue <code>https://www.meteoblue.com/</code>","tags":["wep007","weather"]},{"location":"weps/wep007/#wmo-weather-codes-wmo-4677","title":"WMO Weather Codes (WMO 4677)","text":"<p>Standard weather codes used by Open-Meteo and many national services:</p> Code Description 0 Clear sky 1, 2, 3 Mainly clear, partly cloudy, overcast 45, 48 Fog and depositing rime fog 51, 53, 55 Drizzle: Light, moderate, dense 56, 57 Freezing drizzle: Light, dense 61, 63, 65 Rain: Slight, moderate, heavy 66, 67 Freezing rain: Light, heavy 71, 73, 75 Snow fall: Slight, moderate, heavy 77 Snow grains 80, 81, 82 Rain showers: Slight, moderate, violent 85, 86 Snow showers: Slight, heavy 95 Thunderstorm: Slight or moderate 96, 99 Thunderstorm with slight/heavy hail","tags":["wep007","weather"]},{"location":"weps/wep007/#architecture-concept","title":"Architecture Concept","text":"","tags":["wep007","weather"]},{"location":"weps/wep007/#phase-1-frontend-display-only","title":"Phase 1: Frontend Display Only","text":"<ul> <li>Frontend fetches 14-day forecast directly from Open-Meteo</li> <li>Display on hut detail page</li> <li>Link to country-specific detailed forecast</li> <li>No backend storage</li> </ul>","tags":["wep007","weather"]},{"location":"weps/wep007/#phase-2-backend-storage-for-search","title":"Phase 2: Backend Storage for Search","text":"<p>Data Model:</p> <pre><code>WeatherForecast\n- location_id (group nearby huts)\n- date\n- temperature_max\n- temperature_min\n- precipitation_probability\n- precipitation_sum\n- weather_code\n- wind_speed\n- snow_depth (if applicable)\n</code></pre> <p>Daily Update Job:</p> <ul> <li>Fetch forecast for all location clusters</li> <li>Store 14 days of daily data per location</li> <li>Link huts to nearest weather location</li> </ul> <p>Search Capabilities:</p> <ul> <li>Filter huts by weather conditions</li> <li>Query by temperature range, precipitation, snow conditions</li> <li>Find \"good weather weekends\"</li> </ul>","tags":["wep007","weather"]},{"location":"weps/wep007/#preliminary-conclusion","title":"Preliminary Conclusion","text":"<ul> <li>Primary API: Open-Meteo (free, comprehensive, Alpine-optimized)</li> <li>Icons: Basmilius (modern design) or MeteoSwiss (more familiar to users, requires WMO code mapping)</li> <li>National Services: Link to MeteoSwiss (CH), ZAMG (AT), etc. for detailed forecasts</li> <li>Phase 1: Frontend-only 14-day display</li> <li>Phase 2: Backend storage for weather-based hut search</li> </ul>","tags":["wep007","weather"]},{"location":"weps/wep007/#implementation-status","title":"Implementation Status","text":"","tags":["wep007","weather"]},{"location":"weps/wep007/#completed-phase-0-foundation","title":"Completed (Phase 0: Foundation)","text":"<ul> <li>WMO Weather Code System: Full support for WMO 4677 standard (100 codes: 0-99)</li> <li>Universal weather code definitions with multilingual descriptions (DE/FR/IT/EN)</li> <li>Separation of weather codes from symbol collections</li> <li>Support for both forecast codes (0-3, 45-99) and observational codes (4-44)</li> <li>Category-based organization (clear, cloudy, rain, snow, fog, etc.)</li> <li>Symbol Collection Management: Flexible system for multiple icon providers</li> <li>MeteoSwiss filled icon collection with day/night variants (84 icons)</li> <li>Weather-icons collections: filled, outlined, outlined-mono, filled-animated, outlined-animated (236+ icons each)</li> <li>Collection-based symbol mapping system (one WMO code \u2192 multiple collections)</li> <li>Extensible symbol style system supporting 11 styles (detailed, simple, mono, outlined, filled, and animated variants)</li> <li>Import Scripts: Automated data import from multiple sources</li> <li>MeteoSwiss icon downloader with priority-based selection</li> <li>Weather-icons batch importer supporting all styles</li> <li>WMO code mapping with complete translations and categories</li> <li>Automatic verification of forecast code coverage</li> <li>API Endpoints: RESTful API for weather codes and symbols</li> <li>Query by collection, category, and individual codes</li> <li>Configurable response detail levels (no/slug/all for symbols, categories, collections)</li> <li>SVG redirect endpoints for efficient icon delivery</li> <li>HTTP caching with Cache-Control headers (60s dev, 7 days production)</li> <li>Default collection: weather-icons-outlined-mono</li> <li>Database Optimization: Complete indexing and query optimization</li> <li>Foreign key indexes on all relationships</li> <li>Composite indexes for common query patterns (collection+code, code+collection)</li> <li>Check constraints for data integrity</li> <li>Admin interface optimized with targeted prefetch queries</li> <li>Disabled inlines for large datasets to improve performance</li> </ul>","tags":["wep007","weather"]},{"location":"weps/archive/2026/","title":"2026","text":""},{"location":"weps/archive/2025/","title":"2025","text":""},{"location":"weps/category/wep/","title":"WEP","text":""},{"location":"weps/category/weather/","title":"Weather","text":""},{"location":"weps/category/routing/","title":"Routing","text":""},{"location":"weps/category/infrastructure/","title":"Infrastructure","text":""},{"location":"weps/category/huts/","title":"Huts","text":""},{"location":"weps/category/accessibility/","title":"Accessibility","text":""},{"location":"weps/category/public-transport/","title":"Public Transport","text":""},{"location":"weps/category/data-sources/","title":"Data Sources","text":""},{"location":"weps/category/spatial-analysis/","title":"Spatial Analysis","text":""}]}